<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>能带论 | 小径</title><meta name="author" content="Xuxu"><meta name="copyright" content="Xuxu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Bloch定理 能谱结构   平面波法 近自由电子近似 零级近似 一级近似的非简并微扰 简并微扰 布里渊区与能隙 近似简并微扰   紧束缚近似 万尼尔函数 紧束缚近似假设   正交平面波方法 赝势方法 能带电子密度 自由电子的能态密度 紧束缚近似三维简单立方晶体的能带电子密度 紧束缚近似下石墨烯的能带电子密度 紧束缚近似下碳纳米管的能带电子密度    金属电子论不考虑电子电子相互作用和电子离子相">
<meta property="og:type" content="article">
<meta property="og:title" content="能带论">
<meta property="og:url" content="https://xuxu20040407.github.io/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E8%83%BD%E5%B8%A6%E8%AE%BA/index.html">
<meta property="og:site_name" content="小径">
<meta property="og:description" content="Bloch定理 能谱结构   平面波法 近自由电子近似 零级近似 一级近似的非简并微扰 简并微扰 布里渊区与能隙 近似简并微扰   紧束缚近似 万尼尔函数 紧束缚近似假设   正交平面波方法 赝势方法 能带电子密度 自由电子的能态密度 紧束缚近似三维简单立方晶体的能带电子密度 紧束缚近似下石墨烯的能带电子密度 紧束缚近似下碳纳米管的能带电子密度    金属电子论不考虑电子电子相互作用和电子离子相">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xuxu20040407.github.io/img/cover2.jpeg">
<meta property="article:published_time" content="2025-02-22T01:30:06.000Z">
<meta property="article:modified_time" content="2025-09-08T09:08:28.219Z">
<meta property="article:author" content="Xuxu">
<meta property="article:tag" content="固体物理">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xuxu20040407.github.io/img/cover2.jpeg"><link rel="shortcut icon" href="/img/favicon32.ico"><link rel="canonical" href="https://xuxu20040407.github.io/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E8%83%BD%E5%B8%A6%E8%AE%BA/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '能带论',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2025-09-08 17:08:28'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><style type="text/css">
.spoiler {
  display: inline;
}
p.spoiler {
  display: flex;
}
.spoiler a {
  pointer-events: none;
}
.spoiler-blur, .spoiler-blur > * {
  transition: text-shadow .5s ease;
}
.spoiler .spoiler-blur, .spoiler .spoiler-blur > * {
  color: rgba(0, 0, 0, 0);
  background-color: rgba(0, 0, 0, 0);
  text-shadow: 0 0 10px grey;
  cursor: pointer;
}
.spoiler .spoiler-blur:hover, .spoiler .spoiler-blur:hover > * {
  text-shadow: 0 0 5px grey;
}
.spoiler-box, .spoiler-box > * {
  transition: color .5s ease,
  background-color .5s ease;
}
.spoiler .spoiler-box, .spoiler .spoiler-box > * {
  color: black;
  background-color: black;
  text-shadow: none;
}</style><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover2.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="小径"><span class="site-name">小径</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comments-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">能带论</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-22T01:30:06.000Z" title="发表于 2025-02-22 09:30:06">2025-02-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-08T09:08:28.219Z" title="更新于 2025-09-08 17:08:28">2025-09-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/">固体物理</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="能带论"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><ul>
<li><a href="#bloch定理">Bloch定理</a><ul>
<li><a href="#能谱结构">能谱结构</a></li>
</ul>
</li>
<li><a href="#平面波法">平面波法</a></li>
<li><a href="#近自由电子近似">近自由电子近似</a><ul>
<li><a href="#零级近似">零级近似</a></li>
<li><a href="#一级近似的非简并微扰">一级近似的非简并微扰</a></li>
<li><a href="#简并微扰">简并微扰</a></li>
<li><a href="#布里渊区与能隙">布里渊区与能隙</a></li>
<li><a href="#近似简并微扰">近似简并微扰</a></li>
</ul>
</li>
<li><a href="#紧束缚近似">紧束缚近似</a><ul>
<li><a href="#万尼尔函数">万尼尔函数</a></li>
<li><a href="#紧束缚近似假设">紧束缚近似假设</a></li>
</ul>
</li>
<li><a href="#正交平面波方法">正交平面波方法</a></li>
<li><a href="#赝势方法">赝势方法</a></li>
<li><a href="#能带电子密度">能带电子密度</a><ul>
<li><a href="#自由电子的能态密度">自由电子的能态密度</a></li>
<li><a href="#紧束缚近似三维简单立方晶体的能带电子密度">紧束缚近似三维简单立方晶体的能带电子密度</a></li>
<li><a href="#紧束缚近似下石墨烯的能带电子密度">紧束缚近似下石墨烯的能带电子密度</a></li>
<li><a href="#紧束缚近似下碳纳米管的能带电子密度">紧束缚近似下碳纳米管的能带电子密度</a></li>
</ul>
</li>
</ul>
<p>金属电子论不考虑电子电子相互作用和电子离子相互作用；考虑这些相互作用，可以得到能带论。</p>
<p>对于晶体中的多体问题，其哈密顿量为：</p>
<script type="math/tex; mode=display">H=\underbrace{\sum_i\frac{\vec{p_i}^2}{2m_e}}_{\text{电子动能}}+\underbrace{\sum_n\frac{\vec{p_n}^2}{2M_n}}_{\text{离子实动能}}+\underbrace{\frac12\sum_{i\neq j}\frac{e^2}{|\vec{r_i}-\vec{r_j}|}}_{\text{电子电子相互作用}}+\underbrace{\frac12\sum_{n\neq m}\frac{Z_nZ_m e^2}{|\vec{R_n}-\vec{R_m}|}}_{\text{离子实相互作用}}+\underbrace{\sum_{i,n}\frac{eZ_n}{|\vec{r_i}-\vec{R_n}|}}_{\text{电子离子相互作用}}</script><p>能带论做出了以下假设：</p>
<ul>
<li>绝热近似：处理电子问题时，认为离子实在格点上固定不动；<script type="math/tex; mode=display">H_e=\sum_i\left(\frac{\vec{p_i}^2}{2m_e}+\sum_nV_n(\vec{r_i}-\vec{R_n})\right)+\frac12\sum_{i\neq j}\frac{e^2}{|\vec{r_i}-\vec{r_j}|}</script><script type="math/tex; mode=display">\text{Fix}\quad H_n=\sum_n\frac{\vec{p_n}^2}{2M_n}+\frac12\sum_{n\neq m}\frac{Z_nZ_m e^2}{|\vec{R_n}-\vec{R_m}|}</script>在上述假设中，电子和离子实被分开，即电声无耦合。</li>
<li>单电子近似：用平均场来代替电子电子间和电子离子间的相互作用；<script type="math/tex; mode=display">H_e=\sum_i\left(\frac{\vec{p_i}^2}{2m_e}+V(\vec{r},\{\vec{R_n}\})\right)</script></li>
<li>周期场近似：平均场是周期性势场。<script type="math/tex; mode=display">V(\vec{r},\{\vec{R_n}\})=V(\vec{r})=V(\vec{r}+\vec{R_n}),\quad R_n=\sum_i n_ia_i</script>这使得电子的波函数成为布洛赫函数。</li>
</ul>
<p>这样，能带论的核心问题就是求解以下周期势场的单电子问题：</p>
<script type="math/tex; mode=display">[-\frac{\hbar^2}{2m}\nabla^2+V(r)]\psi(r)=E\psi(r)</script><p>这和我们在量子力学中求解的周期势场问题是相同的。一种严格解法是平面波法，两种近似解法为近自由电子近似和紧束缚近似。如何选择两种近似方法，得看材料中的电子表现更像波还是粒子，进一步，是在周期势场中穿梭还是被束缚在原子附近。</p>
<h1><span id="bloch定理">Bloch定理</span></h1><p>周期势场中的哈密顿量是正格矢的周期函数，那么波函数也是吗？并非。考虑周期场中单电子的波函数为$\psi_k^n(\vec{r})$，显然平移后的波函数为：</p>
<script type="math/tex; mode=display">\begin{aligned}
\psi_k^n(\vec{r}+\vec{R})&=\prod_i\hat{T}^{l_i}(a_i)\psi_k^n(\vec{r})\\
&=\prod_i \exp{\frac{i\hat p a_il_i}{\hbar}}\psi_k^n(\vec{r})\\
&=e^{i\vec{k}\cdot\vec{R}}\psi_k^n(\vec{r})
\end{aligned}</script><p>考虑玻恩-冯卡门边界条件：</p>
<script type="math/tex; mode=display">e^{i (\sum_iN_ik_ia_i)}=1\Rightarrow k_i=2\pi \frac{h_i}{N_i a_i},h_i=0,1,2,\cdots,N_i-1</script><p>或者写为分量的形式：</p>
<script type="math/tex; mode=display">\vec{k}=\sum_i k_i\vec{b_i},k_i=\frac{h_i}{N_i}</script><p>将波函数拆开，根据Bloch定理，其相位函数可以确定，振幅函数同样也是一个周期函数：</p>
<script type="math/tex; mode=display">\psi_k^n(\vec{r})=e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})</script><p>这种波函数$u_k^n(\vec{r})$称为布洛赫波函数。</p>
<blockquote>
<p>在描述布洛赫波函数的时候，我们用到了量子数$n$和$k$。量子数$n$表示该电子波函数在晶体原子间距变大的时候，退化为孤立原子的第n个本征态；量子数$k$表示该电子波函数的波矢，不过并不与电子的动量成比例。</p>
</blockquote>
<h2><span id="能谱结构">能谱结构</span></h2><ol>
<li>写出能量本征值方程，并对其作规范变化：<script type="math/tex; mode=display">\begin{aligned}
 &[-\frac{\hbar^2}{2m}\nabla^2+V(r)]e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})=E_n(\vec{k})e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})\\
 \Rightarrow&e^{-i\vec{k}\cdot\vec{r}}[-\frac{\hbar^2}{2m}\nabla^2+V(r)]e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})=e^{-i\vec{k}\cdot\vec{r}}E_n(\vec{k})e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})\\
 \Rightarrow&[-\frac{\hbar^2}{2m}(\nabla-i\vec{k})^2+V(r)]u_k^n(\vec{r})=E_n(\vec{k})u_k^n(\vec{r})\\
 \end{aligned}</script> 记$\hat H_k=-\frac{\hbar^2}{2m}(\nabla-i\vec{k})^2+V(r)$，其仍然是一个厄米算符。</li>
<li>对于确定的$\vec{k}$，由Sturm-Liouville定理，有无数个分立的能量本征值$E_n(\vec{k})$。</li>
<li>对于确定的$n$，能量本征值$E_n(\vec{k})$是一个周期函数，即$E_n(\vec{k})=E_n(\vec{k}+\vec{K_h})$，其中$\vec{K_h}$是倒格矢。这说明能带的计算可以在一个布里渊区内完成。</li>
<li>显然，由于周期性，确定的$n$对应的能量本征值$E_n(\vec{k})$是一个能带（有上下界）；</li>
<li>由于玻恩-冯卡门边界条件，$\vec{k}$的取值是离散的，所以能带在$\vec{k}$轴上是分立的。但是，由于宏观晶体的尺寸较大，$\vec{k}$的取值是准连续的。</li>
</ol>
<p><img src="\img\固体物理\3.png" alt="能带结构"></p>
<h1><span id="平面波法">平面波法</span></h1><p>利用平面波分解可以严格求解周期势场中的单电子薛定谔方程问题。将单电子波函数用倒格矢展开：</p>
<script type="math/tex; mode=display">\psi_k(r)=u_k(r)e^{i\vec{k}·\vec{r}},u_k(r)=\frac{1}{\sqrt{N\Omega}}\sum_h a_k(\vec{K_h})e^{i\vec{K_h}·\vec{r}}</script><p>其中，平面波展开的系数为：</p>
<script type="math/tex; mode=display">\begin{aligned}
a_k(\vec{K_h})&=\frac{1}{\sqrt{N\Omega}}\int u_k(r)e^{-i\vec{K_h}·r}dr\\
&=\frac{1}{\sqrt{N\Omega}}\int \psi_k(r)e^{-i(\vec{k}+\vec{K_h})·\vec{r}}dr\\
&=\frac{1}{\sqrt{N\Omega}}\int \psi_{k+K_h}(r)e^{-i(\vec{k}+\vec{K_h})·\vec{r}}dr\\
&=a(\vec{k}+\vec{K_h})
\end{aligned}</script><p>最终波函数可以写为：</p>
<script type="math/tex; mode=display">\psi_k(r)=\frac{1}{\sqrt{N\Omega}}\sum_h a(\vec{k}+\vec{K_h})e^{i(\vec{k}+\vec{K_h})·\vec{r}}</script><script type="math/tex; mode=display">|\psi_k\rangle=\sum_h a(\vec{k}+\vec{K_h})|\vec{k}+\vec{K_h}\rangle，|\vec{k}+\vec{K_h}\rangle=\frac{1}{\sqrt{N\Omega}} e^{i(\vec{k}+\vec{K_h})·\vec{r}}</script><p>代入波动方程中，并在左侧作用$\langle \vec{k}+\vec{K_{h’}}|$得到：</p>
<script type="math/tex; mode=display">\begin{aligned}
&\langle \vec{k}+\vec{K_{h'}}|\sum_ha(\vec{k}+\vec{K_h})[\hat H-E(\vec{k})]|\vec{k}+\vec{K_h}\rangle\\
=&\sum_h \langle \vec{k}+\vec{K_{h'}}|(-\frac{\hbar^2}{2m}\nabla^2+V(r)-E(\vec{k}))|\vec{k}+\vec{K_h}\rangle\\
=&[\frac{\hbar^2}{2m}(\vec{k}+\vec{K_{h'}})^2-E(\vec{k})]a(\vec{k}+\vec{K_{h'}})+\sum_h \langle \vec{k}+\vec{K_{h'}}|V(r)|\vec{k}+\vec{K_h}\rangle a(\vec{k}+\vec{K_h})\\
=&[\frac{\hbar^2}{2m}(\vec{k}+\vec{K_{h'}})^2-E(\vec{k})]a(\vec{k}+\vec{K_{h'}})+\sum_{h\neq h'} V(\vec{K_{h'}}-\vec{K_h}) a(\vec{k}+\vec{K_h})\\
=&0
\end{aligned}</script><blockquote>
<p>其中，对于势能的计算来自于：</p>
<script type="math/tex; mode=display">\begin{aligned}
\langle \vec{k}+\vec{K_{h'}}|V(r)|\vec{k}+\vec{K_h}\rangle&=\frac{1}{N\Omega}\int V(r)e^{-i(\vec{k}+\vec{K_{h'}})·\vec{r}}e^{i(\vec{k}+\vec{K_h})·\vec{r}}dr\\
&=\frac{1}{N\Omega}\int V(r)e^{-i(\vec{K_{h'}}-\vec{K_h})·\vec{r}}dr\\
&=V(\vec{K_{h'}}-\vec{K_h})
\end{aligned}</script><p>这正是周期势的傅里叶展开：</p>
<script type="math/tex; mode=display">V(\vec{r})=\sum_h V(\vec{K_h})e^{i\vec{K_h}·\vec{r}}=\bar{V}|_{h=0}+\sum_{h\neq 0} V(\vec{K_h})e^{i\vec{K_h}·\vec{r}}</script><p>一般取$\bar{V}=0$。</p>
</blockquote>
<p>至此，我们问题转化为线性齐次方程组的问题。利用行列式为0，可以求解能量本征值的方程：</p>
<script type="math/tex; mode=display">\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|V|\vec{k}+\vec{K}_h\rangle\right\}=0</script><h1><span id="近自由电子近似">近自由电子近似</span></h1><p>尽管平面波是严格求解周期势场中单电子薛定谔方程的方法，但在高阶行列式中，求解往往是难以收敛的。考虑势场的空间变化十分微弱，我们使用量子力学中的微扰论来处理。这时候电子的行为十分接近自由电子，这就是近自由电子近似：</p>
<script type="math/tex; mode=display">V(\vec{r})=\bar{V}+\Delta V(\vec{r})</script><h2><span id="零级近似">零级近似</span></h2><p>如果做零级近似，即$\Delta V=0$，代入平均场，电子的本征解即为平面波解：</p>
<script type="math/tex; mode=display">\psi_k^0(\vec{r})=\frac{1}{\sqrt{N\Omega}}e^{i\vec{k}\vec{r}},E_k^0=\frac{\hbar^2k^2}{2m}+\bar V</script><h2><span id="一级近似的非简并微扰">一级近似的非简并微扰</span></h2><p>将波函数写为：</p>
<script type="math/tex; mode=display">\psi_k(\vec{r})=\frac{a(\vec{k})}{\sqrt{N\Omega}}e^{i\vec{k}\vec{r}}+\sum_{h\neq 0}\frac{a(\vec{k}+\vec{K_h})}{\sqrt{N\Omega}}e^{i(\vec{k}+\vec{K_h})\vec{r}}</script><p>依照微扰理论，可以计算出一阶微扰：</p>
<script type="math/tex; mode=display">a(\vec{k})=1,a(\vec{k}+\vec{K_h})=\frac{V(\vec{K_h})}{\frac{\hbar^2}{2m}[\vec{k}^2-(\vec{k}+\vec{K_h})^2]}</script><p>代入，即可得到能量本征值的二阶近似解：</p>
<script type="math/tex; mode=display">E(\vec{k})=\frac{\hbar^2k^2}{2m}+\bar V+\sum_{h\neq 0}\frac{|V(\vec{K_h})|^2}{\frac{\hbar^2}{2m}[\vec{k}^2-(\vec{k}+\vec{K_h})^2]}</script><p>一般来说，由于周期势很弱，电子本征波函数和电子本征能量和自由电子相差不远，但可见在某些简并情况下发散。</p>
<h2><span id="简并微扰">简并微扰</span></h2><p>观察上述能量表达式，可知当$\vec{k}^2=(\vec{k}+\vec{K_h})^2$时，能量本征值是简并的。此时，其他散射波都可以忽略，最后剩下两个方程：</p>
<script type="math/tex; mode=display">\begin{aligned}
\text{左乘}\langle\psi^0_{\vec{k}}|&\Rightarrow[\frac{\hbar^2}{2m}\vec{k}^2-E(\vec{k})]a(\vec{k})+V(-\vec{K_h})a(\vec{k}+\vec{K_h})=0\\
\text{左乘}\langle\psi^0_{\vec{k}+\vec{K_h}}|&\Rightarrow[\frac{\hbar^2}{2m}(\vec{k}+\vec{K_h})^2-E(\vec{k})]a(\vec{k}+\vec{K_h})+V(\vec{K_h})a(\vec{k})=0\\
\end{aligned}</script><p>其中耦合的波函数为：</p>
<script type="math/tex; mode=display">|\psi\rangle=a(\vec{k})|\psi^0_{\vec{k}}\rangle+a(\vec{k}+\vec{K_h})|\psi^0_{\vec{k}+\vec{K_h}}\rangle</script><p>可以通过行列式：</p>
<script type="math/tex; mode=display">\det\left(\begin{matrix}
[\frac{\hbar^2}{2m}\vec{k}^2-E(\vec{k})] & V(-\vec{K_h}) \\
V(\vec{K_h}) & [\frac{\hbar^2}{2m}(\vec{k}+\vec{K_h})^2-E(\vec{k})]
\end{matrix}\right)=0</script><p>解出：</p>
<script type="math/tex; mode=display">\begin{aligned}
E_{\pm}(\vec{k})&=\frac12\{\frac{\hbar^2}{2m}[\vec{k}^2+(\vec{k}+\vec{K_h}^2)]\pm\sqrt{\frac{\hbar^4}{4m^2}[\vec{k}^2+(\vec{k}+\vec{K_h}^2)]^2+4|V(\vec{K_h})|^2}\}\\
&\approx \frac{\hbar^2}{2m}\vec{k}^2\pm|V(\vec{K_h})|\\
\end{aligned}</script><h2><span id="布里渊区与能隙">布里渊区与能隙</span></h2><p>上述非简并微扰下，当$|\vec{k}|=|\vec{k}+\vec{K_h}|$时，计算发散。这个条件等同于$\vec{k}$落在倒格矢的垂直平分面上。倒格矢的垂直平分面依次围成布里渊区。</p>
<p>为什么会在布里渊区的边界上发生能隙现象呢？入射波遭布拉格衍射后，一般来说相互抵消，不影响入射波；但在布里渊区边界上，<strong>入射波和衍射波叠加形成驻波</strong>。以下是一个简单的图像：</p>
<p>当$k=-\frac{\pi n}{a}$时，$k’=k+\frac{2\pi n}{a}=-k$，波函数$|\psi_k^0\rangle=\frac{1}{\sqrt{L}}e^{ikx}$是简并的，此时需要考虑简并微扰。</p>
<p>左边同乘$\langle\psi^0_k|,\langle\psi^0_{k’}|$，有：</p>
<script type="math/tex; mode=display">\begin{aligned}
E_k^0a+\langle\psi^0_k|\Delta V|\psi^0_{k'}\rangle b&=Ea\\
\langle\psi^0_{k'}|\Delta V|\psi^0_k\rangle a+E_{k'}^0b&=Eb
\end{aligned}</script><p>其中$\langle\psi^0_{k’}|\Delta V|\psi^0_k\rangle=\langle k’|\Delta V|k\rangle=V_n$，由解存在性，有：</p>
<script type="math/tex; mode=display">\begin{aligned}
\begin{vmatrix}
E_k^0-E&V_n^*\\
V_n&E_{k'}^0-E
\end{vmatrix}=0
\end{aligned}</script><p>解得：</p>
<script type="math/tex; mode=display">E_{\pm}=\frac{E_k^0+E_{k'}^0}{2}\pm\sqrt{(\frac{E_k^0-E_{k'}^0}{2})^2+|V_n|^2}=E_k^0\pm|V_n|</script><p>相应的本征波函数为：</p>
<script type="math/tex; mode=display">\begin{aligned}
|\psi_+\rangle&=\frac{1}{\sqrt{2}}(|\psi^0_k\rangle+|\psi^0_{k'}\rangle)=\sqrt{\frac2L}\cos{\frac{n\pi}{a}} \\
|\psi_-\rangle&=\frac{1}{\sqrt{2}}(|\psi^0_k\rangle-|\psi^0_{k'}\rangle)=-i\sqrt{\frac2L}\sin{\frac{n\pi}{a}} 
\end{aligned}</script><p>对于非简并微扰，入射波和衍射波不耦合，但在简并微扰中，我们通过对角化提取出了<strong>驻波</strong>。这意味着能量更高的波函数喜欢出现在两个原子的中间，能量较低的波函数喜欢出现在原子上，这正是能隙的成因。</p>
<p><img src="\img\固体物理\4.png" alt="布里渊区与能隙"></p>
<h2><span id="近似简并微扰">近似简并微扰</span></h2><p>实际问题中，在布里渊区边界的附近，简并微扰也是近似有效的：</p>
<script type="math/tex; mode=display">E_{\pm}=\frac{E_k^0+E_{k'}^0}{2}\pm\sqrt{(\frac{E_k^0-E_{k'}^0}{2})^2+|V_n|^2}</script><p>我们讨论其中的两种退化情形：</p>
<ul>
<li><p>当$|E_k^0-E_{k’}^0|\gg|V_n|$时：</p>
<script type="math/tex; mode=display">E_{\pm}\approx\frac{E_k^0+E_{k'}^0}{2}\pm\frac{E_k^0-E_{k'}^0}{2}(1+\frac{|V_n|^2}{(E_k^0-E_{k'}^0)^2})\Rightarrow\begin{cases}
E_+=E_k^0+\frac{|V_n|^2}{E_k^0-E_{k'}^0}\\E_-=E_{k'}^0-\frac{|V_n|^2}{E_k^0-E_{k'}^0}
\end{cases}</script><p>如果再做一次近似，得到：</p>
<script type="math/tex; mode=display">E_{\pm}\approx E_k^0=\frac{\hbar^2k^2}{2m}+\bar V</script><p>这说明，当距离布里渊边界较远的时候，能量曲线为抛物线，可以忽略微扰。</p>
</li>
<li><p>当$|E_k^0-E_{k’}^0|\ll|V_n|$时：</p>
<script type="math/tex; mode=display">E_{\pm}\approx\frac{E_k^0+E_{k'}^0}{2}\pm|V_n|(1+\frac{(E_k^0-E_{k'}^0)^2}{8|V_n|^2})</script><p>代入$k=-\frac{n\pi}{a}(1-\Delta),k’=\frac{n\pi}{a}(1+\Delta)$，有：</p>
<script type="math/tex; mode=display">\begin{cases}
E_+= V+T_n+|V_n|+ \Delta^2T_n(\frac{2T_n}{|V_n|}+1)\\
E_-=V+T_n-|V_n|- \Delta^2T_n(\frac{2T_n}{|V_n|}-1)
\end{cases}</script><p>其中$T_n=\frac{\hbar^2n^2\pi^2}{2ma^2}$，这意味着在距离布里渊边界较近的时候，$\Delta\rightarrow0$，能量曲线为带有能隙的抛物线。可以看到，能量差值是以布里渊边界为零点的抛物线函数，所以能看到能隙是弯弯的。</p>
</li>
</ul>
<p><img src="\img\固体物理\6.png" alt="抛物线能带"></p>
<h1><span id="紧束缚近似">紧束缚近似</span></h1><h2><span id="万尼尔函数">万尼尔函数</span></h2><p>在平面波方法中，我们将布洛赫波函数按平面波（复数）展开。实际上，由于布洛赫波函数是倒空间的周期函数，所以也可以用正空间的周期函数展开：</p>
<script type="math/tex; mode=display">\psi_k^n(\vec{r})=\frac1{\sqrt{N}}\sum_{l}a_n(\vec{R}_l,\vec{r})e^{i\vec{k}\cdot\vec{R}_l}</script><p>其中$a_n(\vec{R}_l,\vec{r})$称为万尼尔函数：</p>
<script type="math/tex; mode=display">a_n(\vec{R}_l,\vec{r})=\frac1{\sqrt{N}}\sum_{\vec{k}}\psi_k^n(\vec{r})e^{-i\vec{k}\cdot\vec{R}_l}=\frac1{\sqrt{N}}\sum_{\vec{k}}u_k^n(\vec{r}-\vec{R}_l)e^{-i\vec{k}\cdot(\vec{r}-\vec{R})}</script><p>可见万尼尔函数只是宗量$\vec{r}-\vec{R}_l$的函数（这说明万尼尔函数是以$\vec{R}_l$为中心的局域函数），记：</p>
<script type="math/tex; mode=display">a_n(\vec{R}_l,\vec{r})=a_n(\vec{r}-\vec{R}_l)</script><p>不难证明万尼尔函数是正交完备的：</p>
<ul>
<li>正交性：<script type="math/tex; mode=display">\begin{aligned}
  \int a_n^*(\vec{r}-\vec{R}_l)a_{n'}(\vec{r}-\vec{R}_{l'})d\vec{r}&=\frac1N\sum_{\vec{k}}\sum_{\vec{k'}}\int \psi_k^n(\vec{r})^*\psi_{k'}^{n'}(\vec{r})e^{-i\vec{k}\cdot\vec{R}_l+\vec{k'}\cdot\vec{R}_{l'}}d\vec{r}\\
  &=\frac1N\sum_{\vec{k}}\sum_{\vec{k'}}\delta_{n,n'}\delta_{\vec{k},\vec{k'}}e^{-i\vec{k}\cdot\vec{R}_l+\vec{k'}\cdot\vec{R}_{l'}}\\
  &=\frac1N\sum_{\vec{k}}\delta_{n,n'}e^{-i\vec{k}\cdot(\vec{R}_l-\vec{R}_{l'})}\\
  &=\delta_{n,n'}\delta_{l,l'}
  \end{aligned}</script></li>
<li>完备性：<script type="math/tex; mode=display">\begin{aligned}
  \sum_{l,n}a_n^*(\vec{r}-\vec{R}_l)a_n(\vec{r}-\vec{R}_l)&=\frac1N\sum_{\vec{k}}\sum_{\vec{k'}}\sum_{l,n} \psi_k^n(\vec{r})^*\psi_{k'}^n(\vec{r})e^{-i\vec{k}\cdot\vec{R}_l+\vec{k'}\cdot\vec{R}_l}\\
  &=\delta(\vec{r}-\vec{r}')
  \end{aligned}</script></li>
</ul>
<h2><span id="紧束缚近似假设">紧束缚近似假设</span></h2><p>紧束缚近似的基本假设为：晶体中每个原子的势场对电子都有较强的束缚，使得电子的行为接近孤立原子中的电子。这时候，其他原子对该电子的吸引势被看作微扰。</p>
<p>在紧束缚近似假设下，可以选择孤立原子的定域波函数$\varphi_n(\vec{r}-\vec{R}_l)$作为万尼尔函数：</p>
<script type="math/tex; mode=display">\left[-\frac{\hbar^2}{2m}\nabla^2+U(\vec{r}-\vec{R}_l)\right]\varphi_n(\vec{r}-\vec{R}_l)=E_n\varphi_n(\vec{r}-\vec{R}_l)</script><p>于是周期势场中的单电子波函数可以用上述函数展开：</p>
<script type="math/tex; mode=display">\psi_k^n(\vec{r})=\frac1{\sqrt{N}}\sum_{l}\varphi_n(\vec{r}-\vec{R}_l)e^{i\vec{k}\cdot\vec{R}_l}</script><p>指标n表示不同轨道类型的波函数，如s和p轨道。该方法之所以是一种近似，是因为不同孤立原子的波函数之间是有重叠的，但在紧束缚假设中，重叠的部分很少，可以近似正交：</p>
<script type="math/tex; mode=display">\int \varphi_n^*(\vec{r}-\vec{R}_l)\varphi_{n'}(\vec{r}-\vec{R}_{l'})d\vec{r}=\delta_{n,n'}\delta_{l,l'}</script><p>代入周期势场的单电子薛定谔方程：</p>
<script type="math/tex; mode=display">\begin{aligned}
&\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})\right]\psi_k^n(\vec{r})=E_n(\vec{k})\psi_k^n(\vec{r})\\
\Rightarrow&\frac1{\sqrt{N}}\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E_n(\vec{k})\right]\sum_{l'}\varphi_n(\vec{r}-\vec{R}_{l'})e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow&\frac1{\sqrt{N}}\sum_{l'}\left[E_n-U(\vec{r}-\vec{R}_{l'})+V(\vec{r})-E_n(\vec{k})\right]\varphi_n(\vec{r}-\vec{R}_{l'})e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\end{aligned}</script><p>其中$V(\vec{r})=\sum_l U(\vec{r}-\vec{R}_l)$。左乘$\varphi_n^*(\vec{r}-\vec{R}_{l})$并对$\vec{r}$积分，利用正交性得到：</p>
<script type="math/tex; mode=display">\begin{aligned}
&[E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}+\int d\vec{r}\sum_{l'}\left[V(\vec{r})-U(\vec{r}-\vec{R}_{l'})\right]\varphi_n^*(\vec{r}-\vec{R}_{l'})\varphi_n(\vec{r}-\vec{R}_l)e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow& [E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}+\int d\vec{r}\sum_{l'}\left[V(\vec{r}-\vec{R}_{l'})-U(\vec{r}-\vec{R}_{l'})\right]\varphi_n^*(\vec{r}-\vec{R}_{l'})\varphi_n(\vec{r}-\vec{R}_l)e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\xi=\vec{r}-\vec{R}_{l'}\Rightarrow& [E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}+\sum_{l'}\int d\vec{r}\left[V(\xi)-U(\xi)\right]\varphi_n^*[\xi-(\vec{R}_l-\vec{R}_{l'})]\varphi_n(\xi)e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow& [E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}-\sum_{l'}J(\vec{R}_l-\vec{R}_{l'})e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow& E_n(\vec{k})=E_n-\sum_{l'}J(\vec{R}_l-\vec{R}_{l'})e^{i\vec{k}\cdot(\vec{R}_{l'}-\vec{R}_{l})}\\
\end{aligned}</script><p>只取最邻近项：</p>
<script type="math/tex; mode=display">\begin{aligned}
E_n(\vec{k})&=E_n-J(0)-\sum_{l\neq l'}^{\text{最近邻}}J(\vec{R}_l-\vec{R}_{l'})e^{-i\vec{k}\cdot(\vec{R}_{l}-\vec{R}_{l'})}\\&=E_n-J(0)-\sum_{s\neq 0}^{\text{最近邻}}J(\vec{R}_s)e^{-i\vec{k}\cdot\vec{R}_{s}}\end{aligned}</script><blockquote>
<p>讨论以上公式的物理意义。当原子的间距$\vec{R}_l$较大的时候，电子表现出孤立原子的特征：</p>
<script type="math/tex; mode=display">E_n(\vec{k})\approx E_n</script><p>即能带是由简并态的直线进化而来的。这点从下述讨论的三维简单立方晶体的能带结构中可以看出。</p>
<p>考虑晶体结构，简并态被打破，这是由于其他原子对电子的吸引势。交叠积分$J(\vec{R}_l-\vec{R}_{l’})$其实代表了第l’个原子跃迁到第l个原子时的跃迁矩阵元：</p>
<script type="math/tex; mode=display">\begin{aligned}\langle l|H|l'\rangle&=\langle l|H_{l'}|l'\rangle+\langle l|\Delta V_{l'}|l'\rangle\\&=\langle l|\Delta V_{l'}|l'\rangle\\&=\int d\vec{r}\left[V(\vec{r})-U(\vec{r}-\vec{R}_{l'})\right]\varphi_n^*(\vec{r}-\vec{R}_l)\varphi_n(\vec{r}-\vec{R}_{l'})\\&=J(\vec{R}_l-\vec{R}_{l'})\end{aligned}</script><p>可以用微扰的角度看待$J(0)$项。</p>
<p><img src="\img\固体物理\微扰势.png" alt="alt"></p>
<p>如图所示，$V(\vec{r})-U(\vec{r}-\vec{R}_{l})$是一个在$\vec{r}=\vec{R}_{l}$处的微扰势场，所以当$l=l’$时，$J(0)$可以通过微扰论得到：</p>
<script type="math/tex; mode=display">J(0)=\langle \varphi_{n}(\vec{r}-\vec{R}_{l})|V(\vec{r})-U(\vec{r}-\vec{R}_{l})|\varphi_{n}(\vec{r}-\vec{R}_{l})\rangle</script></blockquote>
<h1><span id="正交平面波方法">正交平面波方法</span></h1><p>从上述的讨论中，我们发现，离子实区域外的电子受到周期势场的作用，更像一个波；而离子实区域内的电子受到孤立原子势场的作用，更像一个粒子。对于两种电子，分类讨论可以解决平面波方法的收敛问题。</p>
<p>若内层有M个电子态，他们仍可以使用相应的独立原子轨道为拟合：</p>
<script type="math/tex; mode=display">|\psi_c\rangle=\varphi_c(\vec{r}-\vec{R}_l),c=1,2,...,M</script><p>对于外层的非定域电子（离子实内振荡，离子实外平滑），如果使用平面波，就无法避免高能平面波的引入。为了解决这一问题，考虑将此前的M个原子轨道作为基函数的一部分，线性组合得到：</p>
<script type="math/tex; mode=display">|\psi_k\rangle=\sum_{c=1}^M \beta_c|\psi_c\rangle+\sum_{h} a(\vec{k}+\vec{K}_h)|\vec{k}+\vec{K}_h\rangle</script><p>这样可以有效减少平面波的引入。考虑外层波函数与内层波函数的正交性：</p>
<script type="math/tex; mode=display">\langle \psi_k|\psi_c\rangle=0\Rightarrow 
\beta_c=-\sum_h a(\vec{k}+\vec{K}_h)\langle \psi_c|\vec{k}+\vec{K}_h\rangle</script><p>得到新的基组叫做正交平面波（Orthogonal Plane Wave，OPW）基组：</p>
<script type="math/tex; mode=display">|OPW_{\vec{k}}\rangle=|\vec{k}\rangle-\sum_{c=1}^M |\psi_c\rangle\langle\psi_c|\vec{k}\rangle</script><p>这样，外层波函数就可以表示为：</p>
<script type="math/tex; mode=display">|\psi_k\rangle=\sum_{h=1}^N a(\vec{k}+\vec{K}_h)|OPW_{\vec{k}+\vec{K}_h}\rangle</script><blockquote>
<p>新的正交平面波基组自身反而不正交了，这导致在计算能量本征值时需要引入重叠矩阵的概念。</p>
<p>考虑基组$\{|\phi_i\rangle\}$，薛定谔方程指出存在本征能量和波函数：</p>
<script type="math/tex; mode=display">\hat H|\psi\rangle=E|\psi\rangle</script><p>其中$|\psi\rangle=\sum_i c_i|\phi_i\rangle$，代入后有：</p>
<script type="math/tex; mode=display">\sum_i c_i\hat H|\phi_i\rangle=E\sum_i c_i|\phi_i\rangle</script><p>左乘$\langle \phi_j|$，有：</p>
<script type="math/tex; mode=display">\sum_i c_i\langle \phi_j|\hat H|\phi_i\rangle=E\sum_i c_i\langle \phi_j|\phi_i\rangle</script><ul>
<li>对于正交基组，$\langle \phi_j|\phi_i\rangle=\delta_{ij}$，有：<script type="math/tex; mode=display">\sum_i c_i\langle \phi_j|\hat H|\phi_i\rangle=c_jE\Rightarrow H\vec{c}=E\vec{c}</script></li>
<li>对于非正交基组，$\langle \phi_j|\phi_i\rangle=S_{ij}$，有：<script type="math/tex; mode=display">\sum_i c_i\langle \phi_j|\hat H|\phi_i\rangle=E\sum_i c_iS_{ij}\Rightarrow H\vec{c}=E S\vec{c}</script>这说明在非正交基组下，需要求解的是带有重叠矩阵的广义本征值问题。</li>
</ul>
</blockquote>
<h1><span id="赝势方法">赝势方法</span></h1><p>将正交平面波展开代入薛定谔方程：</p>
<script type="math/tex; mode=display">\begin{aligned}
&\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E(\vec{k})\right]\sum_{h} a(\vec{k}+\vec{K}_h)|OPW_{\vec{k}+\vec{K}_h}\rangle=0\\
\Rightarrow&\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E(\vec{k})\right]|\vec{k}+\vec{K}_h\rangle-\sum_{c=1}^M \left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E(\vec{k})\right]|\psi_c\rangle\langle\psi_c|\vec{k}+\vec{K}_h\rangle\right\}=0\\
\Rightarrow&\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_h)^2+V(\vec{r})-E(\vec{k})\right]|\vec{k}+\vec{K}_h\rangle-\sum_{c=1}^M \left[E_c-E(\vec{k})\right]|\psi_c\rangle\langle\psi_c|\vec{k}+\vec{K}_h\rangle\right\}=0\\
\Rightarrow&\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_h)^2-E(\vec{k})\right]|\vec{k}+\vec{K}_h\rangle+U|\vec{k}+\vec{K}_h\rangle\right\}=0\\
\end{aligned}</script><p>其中：</p>
<script type="math/tex; mode=display">U=V-\sum_{c=1}^M \left[E_c-E(\vec{k})\right]|\psi_c\rangle\langle\psi_c|</script><p>变为矩阵方程：</p>
<script type="math/tex; mode=display">\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_h)^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|U|\vec{k}+\vec{K}_h\rangle\right\}=0</script><p>行列式为0：</p>
<script type="math/tex; mode=display">\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|U|\vec{k}+\vec{K}_h\rangle\right\}=0</script><blockquote>
<p>其具有和平面波方法矩阵方程同样的形式。以下是对比：</p>
<ul>
<li>平面波方法：<script type="math/tex; mode=display">\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|V|\vec{k}+\vec{K}_h\rangle\right\}=0</script></li>
<li>正交平面波方法：<script type="math/tex; mode=display">\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|U|\vec{k}+\vec{K}_h\rangle\right\}=0</script></li>
</ul>
</blockquote>
<p>将正交平面波方法导出的方程进行变形：</p>
<script type="math/tex; mode=display">\left[-\frac{\hbar^2}{2m}\nabla^2-E(\vec{k})+U\right]\sum_{h} a(\vec{k}+\vec{K}_h)|\vec{k}+\vec{K}_h\rangle=0</script><p>相比于真实的薛定谔方程，我们将正交平面波基组替换为平面波基组，将真实势能$V(\vec{r})$替换为赝势$U(\vec{r})$。这代表我们通过改变势能为一个更加平滑的赝势来简化问题，得到了平滑解。对于只关心离子实外能带的情况，不失为一种简化。</p>
<h1><span id="能带电子密度">能带电子密度</span></h1><p>能带论除了考虑能带的色散关系，还得考虑能带上的电子密度。考虑能带的准连续性，可以用delta函数的筛选性表示为：</p>
<script type="math/tex; mode=display">N_n(E)=\frac{2V}{(2\pi)^3}\int_{\Omega^*} d\vec{k}\delta[E-E_n(\vec{k})]</script><p>其中$N_n(E)$为能带$n$上能量为$E$的电子数密度。</p>
<p>一般可以表示为更为实用的形式：</p>
<script type="math/tex; mode=display">N_n(E)=\frac{2V}{(2\pi)^3}\int dS_E\frac{1}{|\nabla_{\vec{k}}E_n(\vec{k})|}</script><p>其中$dS_E$为能带$n$上能量为$E$的$\vec{k}$空间的面积元，该积分在等能面上积分，通常需要数值计算的帮助。</p>
<p>考虑不同能带的交叠，最终的电子密度为：</p>
<script type="math/tex; mode=display">N(E)=\sum_n N_n(E)</script><h2><span id="自由电子的能态密度">自由电子的能态密度</span></h2><p>自由电子的能谱为：</p>
<script type="math/tex; mode=display">E(\vec{k})=\frac{\hbar^2k^2}{2m}</script><p>能带电子密度为：</p>
<script type="math/tex; mode=display">N(E)=\frac{2V}{(2\pi)^3}\times 4\pi k^2\times (\frac{\hbar^2k}{m})^{-1}=\frac{V}{2\pi^2}\left(\frac{2m}{\hbar^2}\right)^{3/2}E^{1/2}</script><p>同样的道理，可以计算其他维度的能态密度，这里仅给出正比关系：</p>
<script type="math/tex; mode=display">N(E)\propto E^{\frac{d-2}{2}}</script><blockquote>
<p>具体计算过程见  <a href="/2024/11/26/%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E7%BB%9F%E8%AE%A1%E7%89%A9%E7%90%86/%E8%BF%91%E7%8B%AC%E7%AB%8B%E7%B2%92%E5%AD%90%E7%9A%84%E6%9C%80%E6%A6%82%E7%84%B6%E5%88%86%E5%B8%83/" title="近独立粒子的最概然分布">近独立粒子的最概然分布</a> 。这里复述结果（未计入自旋简并度）：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>维度</th>
<th>态密度 $D(\epsilon)$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>$\dfrac{L}{2\pi\hbar}\sqrt{\dfrac{2m}{\epsilon}}$</td>
</tr>
<tr>
<td>2</td>
<td>$\dfrac{S}{2\pi} \dfrac{m}{\hbar^2}$</td>
</tr>
<tr>
<td>3</td>
<td>$\dfrac{V}{4\pi^2}(\dfrac{2m}{\hbar^2})^\frac32\sqrt{\epsilon}$</td>
</tr>
</tbody>
</table>
</div>
</blockquote>
<h2><span id="紧束缚近似三维简单立方晶体的能带电子密度">紧束缚近似三维简单立方晶体的能带电子密度</span></h2><p>考虑紧束缚近似下的简单立方晶体，能带色散关系为：</p>
<script type="math/tex; mode=display">\begin{aligned}
E_n(\vec{k})&=E_n-J(0)-\sum_{s\neq 0}^{\text{最近邻}}J(\vec{R}_s)e^{-i\vec{k}\cdot\vec{R}_{s}}\\
&=E_n-J(0)-(e^{-i k_x a}+e^{-i k_y a}+e^{-i k_z a}+e^{i k_x a}+e^{i k_y a}+e^{i k_z a})J(1)\\
&=E_n-J(0)-6J(1)\cos(k_xa)\cos(k_ya)\cos(k_za)\\
\end{aligned}</script><p>沿高对称路径，通过数值计算可以得到能带色散关系和能带电子密度的图像如下：</p>
<p><img src="\img\固体物理\density.png" alt="alt"></p>
<p>它是由简并态的直线进化而来的：</p>
<p><img src="\img\固体物理\能带进化.png" alt="alt"></p>
<p>绘图代码为：<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> integrate</span><br><span class="line"><span class="keyword">import</span> matplotlib.font_manager <span class="keyword">as</span> fm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 设置中文字体</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># 设置中文字体为黑体</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>  <span class="comment"># 解决负号显示异常问题</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数设置</span></span><br><span class="line">J1 = <span class="number">1.0</span>      <span class="comment"># hopping积分 (单位: eV)</span></span><br><span class="line">a = <span class="number">1.0</span>       <span class="comment"># 晶格常数</span></span><br><span class="line">E0 = <span class="number">0.0</span>      <span class="comment"># 能带中心</span></span><br><span class="line">Nk = <span class="number">300</span>      <span class="comment"># 每个方向的k点数量</span></span><br><span class="line">Nbins = <span class="number">300</span>   <span class="comment"># 能量分箱数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成k空间网格 (第一布里渊区: -π/a ≤ k ≤ π/a)</span></span><br><span class="line">k = np.linspace(-np.pi/a, np.pi/a, Nk)</span><br><span class="line">kx, ky, kz = np.meshgrid(k, k, k, indexing=<span class="string">&#x27;ij&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算能带能量 E(k)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">energy</span>(<span class="params">kx, ky, kz, E0, J1, a</span>):</span><br><span class="line">    <span class="keyword">return</span> E0 - <span class="number">2</span>*J1*(np.cos(kx*a) + np.cos(ky*a) + np.cos(kz*a))</span><br><span class="line"></span><br><span class="line">E = energy(kx, ky, kz, E0, J1, a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算态密度 N(E)</span></span><br><span class="line">E_min, E_max = E0 - <span class="number">6</span>*J1, E0 + <span class="number">6</span>*J1  <span class="comment"># 能量范围</span></span><br><span class="line">E_bins = np.linspace(E_min, E_max, Nbins)</span><br><span class="line">N = np.zeros_like(E_bins)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数值积分: 统计每个能量区间的态密度贡献</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Nbins-<span class="number">1</span>):</span><br><span class="line">    mask = (E &gt;= E_bins[i]) &amp; (E &lt; E_bins[i+<span class="number">1</span>])</span><br><span class="line">    N[i]= np.<span class="built_in">sum</span>(mask)  <span class="comment"># 统计每个能量区间的k点数量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 归一化 (考虑k空间体积和网格密度)</span></span><br><span class="line">N = (N-N.<span class="built_in">min</span>()) / (N.<span class="built_in">max</span>()-N.<span class="built_in">min</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 创建包含两个子图的图形</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">5</span>), dpi=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 子图1: 能带结构图 (左)</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义高对称路径 Γ→X→M→Γ→R</span></span><br><span class="line">k_path = np.array([</span><br><span class="line">    [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],       <span class="comment"># Γ</span></span><br><span class="line">    [np.pi/a, <span class="number">0</span>, <span class="number">0</span>], <span class="comment"># X</span></span><br><span class="line">    [np.pi/a, np.pi/a, <span class="number">0</span>], <span class="comment"># M</span></span><br><span class="line">    [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],       <span class="comment"># Γ</span></span><br><span class="line">    [np.pi/a, np.pi/a, np.pi/a] <span class="comment"># R</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在路径上采样</span></span><br><span class="line">n_points = <span class="number">100</span></span><br><span class="line">k_interp = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k_path)-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> np.linspace(<span class="number">0</span>, <span class="number">1</span>, n_points):</span><br><span class="line">        k_interp.append(k_path[i] + t*(k_path[i+<span class="number">1</span>] - k_path[i]))</span><br><span class="line">k_interp = np.array(k_interp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算能带</span></span><br><span class="line">E_band = energy(k_interp[:,<span class="number">0</span>], k_interp[:,<span class="number">1</span>], k_interp[:,<span class="number">2</span>], E0, J1, a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制能带</span></span><br><span class="line">x_axis = np.arange(<span class="built_in">len</span>(k_interp))</span><br><span class="line">plt.plot(x_axis, E_band, <span class="string">&#x27;r-&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标记高对称点</span></span><br><span class="line">high_sym_pos = [<span class="number">0</span>, n_points, <span class="number">2</span>*n_points, <span class="number">3</span>*n_points, <span class="number">4</span>*n_points-<span class="number">1</span>]</span><br><span class="line">high_sym_labels = [<span class="string">&#x27;Γ&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;Γ&#x27;</span>, <span class="string">&#x27;R&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pos, label <span class="keyword">in</span> <span class="built_in">zip</span>(high_sym_pos, high_sym_labels):</span><br><span class="line">    plt.axvline(x_axis[pos], color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置x轴刻度</span></span><br><span class="line">plt.xticks([x_axis[pos] <span class="keyword">for</span> pos <span class="keyword">in</span> high_sym_pos], high_sym_labels)</span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="built_in">len</span>(x_axis)-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 坐标轴标签和标题</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;高对称点&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">r&#x27;能量 $E-J_0-nJ_1$ (eV)&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;(a) 能带结构 (Γ→X→M→Γ→R路径)&#x27;</span>, y=<span class="number">1.02</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 子图2: 能带电子态密度曲线 (右)</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制态密度曲线</span></span><br><span class="line">plt.plot(E_bins[:-<span class="number">1</span>], N[:-<span class="number">1</span>], <span class="string">&#x27;k-&#x27;</span>, lw=<span class="number">2</span>, label=<span class="string">&#x27;态密度&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在Γ点附近进行√E拟合 (能带底部附近)</span></span><br><span class="line"><span class="comment"># 找到能带最小值附近的区域 (最低10%的能量范围)</span></span><br><span class="line">E_range = E_max - E_min</span><br><span class="line">fit_range = <span class="number">0.1</span> * E_range  <span class="comment"># 取最低10%能量范围进行拟合</span></span><br><span class="line">mask_fit = (E_bins &lt; (E_min + fit_range)) &amp; (E_bins &gt; E_min)  <span class="comment"># 拟合区域</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备拟合数据</span></span><br><span class="line">x_fit = E_bins[mask_fit][:-<span class="number">1</span>] - E_min  <span class="comment"># 相对于Γ点的能量</span></span><br><span class="line">y_fit = N[mask_fit][:-<span class="number">1</span>]  <span class="comment"># 对应的态密度</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义√E拟合函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sqrt_func</span>(<span class="params">x, a</span>):</span><br><span class="line">    <span class="keyword">return</span> a * np.sqrt(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行拟合 (使用非负最小二乘)</span></span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> curve_fit</span><br><span class="line">popt, pcov = curve_fit(sqrt_func, x_fit, y_fit, p0=[<span class="number">1.0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成拟合曲线</span></span><br><span class="line">E_range = E0 - E_min</span><br><span class="line">x_plot = np.linspace(<span class="number">0</span>, E_range, <span class="number">100</span>)</span><br><span class="line">y_plot = sqrt_func(x_plot, *popt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制拟合曲线</span></span><br><span class="line">plt.plot(x_plot + E_min, y_plot, <span class="string">&#x27;b--&#x27;</span>, lw=<span class="number">2</span>, </span><br><span class="line">         label=<span class="string">f&#x27;√E拟合&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标记Γ点位置</span></span><br><span class="line">plt.axvline(E_min, color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">high_sym_pos = [<span class="number">0</span>, Nbins//<span class="number">3</span>, <span class="number">2</span>*Nbins//<span class="number">3</span>-<span class="number">1</span>, <span class="number">3</span>*Nbins//<span class="number">3</span>-<span class="number">2</span>]</span><br><span class="line">high_sym_labels = [<span class="string">&#x27;Γ(n=-6)&#x27;</span>, <span class="string">&#x27;X(n=-2)&#x27;</span>, <span class="string">&#x27;M(n=2)&#x27;</span>,<span class="string">&#x27;R(n=6)&#x27;</span>]</span><br><span class="line">x_axis_dos = E_bins[:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> pos, label <span class="keyword">in</span> <span class="built_in">zip</span>(high_sym_pos, high_sym_labels):</span><br><span class="line">    plt.axvline(x_axis_dos[pos], color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置x轴刻度</span></span><br><span class="line">plt.xticks([x_axis_dos[pos] <span class="keyword">for</span> pos <span class="keyword">in</span> high_sym_pos], high_sym_labels)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 坐标轴标签和标题</span></span><br><span class="line">plt.xlabel(<span class="string">r&#x27;能量 $E-J_0-nJ_1$ (eV)&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylabel(<span class="string">r&#x27;电子态密度 $N(E)$&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;(b) 能带电子态密度曲线&#x27;</span>, y=<span class="number">1.02</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="literal">None</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调整子图间距</span></span><br><span class="line">plt.tight_layout()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p>这里用到了能带色散关系的求导：</p>
<script type="math/tex; mode=display">\nabla_{\vec{k}}E_n(\vec{k}) = 2aJ(1)\sqrt{\sin^2(k_xa)+\sin^2(k_ya)+\sin^2(k_za)}</script><p>对于带底和带顶进行特殊讨论：</p>
<ul>
<li>带底：当$k_x=k_y=k_z=0$时：<script type="math/tex; mode=display">\begin{aligned}
E_n(\vec{k})&=E_n-J(0)-2J(1)[3-\frac12(k_xa)^2-\frac12(k_ya)^2-\frac12(k_za)^2]=E_n-J(0)-2J(1)\\
&=E_{min}+a^2J(1)k^2\\
&=E_{min}+\frac{\hbar^2}{2m^*_-}k^2
\end{aligned}</script>其中$m^*_-=\frac{\hbar^2}{2a^2J(1)}$，这说明带底的有效质量为正。</li>
<li>带顶：当$k_x=k_y=k_z=\frac{\pi}{a}$时：<script type="math/tex; mode=display">\begin{aligned}
E_n(\vec{k})&=E_n-J(0)-2J(1)[\delta k_x^2+\delta k_y^2+\delta k_z^2]\\
&=E_{max}-a^2J(1)(\delta k_x^2+\delta k_y^2+\delta k_z^2)\\
&=E_{max}+\frac{\hbar^2}{2m^*_+}k^2
\end{aligned}</script>其中$m^*_+=-\frac{\hbar^2}{2a^2J(1)}$，这说明带顶的有效质量为负。</li>
</ul>
<p>带顶和带底的色散关系都类似自由电子，所以在上述图像中，的确可以看到$\sqrt{E}$形式的态密度曲线。可以理论计算出态密度公式：</p>
<script type="math/tex; mode=display">N_-(E)=\frac{V}{2\pi^2}\left(\frac{2m^*_-}{\hbar^2}\right)^{3/2}(E-E_{min})^{1/2}</script><script type="math/tex; mode=display">N_+(E)=\frac{V}{2\pi^2}\left(\frac{2|m^*_+|}{\hbar^2}\right)^{3/2}(E_{max}-E)^{1/2}</script><h2><span id="紧束缚近似下石墨烯的能带电子密度">紧束缚近似下石墨烯的能带电子密度</span></h2><p>先利用二次量子化后的紧束缚模型计算色散关系：</p>
<script type="math/tex; mode=display">\begin{aligned}
\hat H &= -t\sum_{\langle i,j\rangle} (c_i^\dagger c_j + h.c.) \\
&= -t\sum_{\langle i,j\rangle} (a^\dagger b_{\vec{e}_1}+ a^\dagger b_{\vec{e}_2} + a^\dagger b_{\vec{e}_3}+ h.c.) 
\end{aligned}</script><p>其中$t$为跃迁积分，$\langle i,j\rangle$表示最近邻原子对。利用二次量子化的傅里叶展开和正交性公式：</p>
<script type="math/tex; mode=display">c_{\vec{r}_i}=\frac{1}{\sqrt{N}}\sum_{\vec{k}} e^{i\vec{k}\cdot\vec{r}_i} c_{\vec{k}},\quad c_{\vec{r}_j}=\frac{1}{\sqrt{N}}\sum_{\vec{k}} e^{-i\vec{k}\cdot\vec{r}_j} c_{\vec{k}}</script><script type="math/tex; mode=display">\frac{1}{\sqrt{N}}\sum_{\vec{k}} e^{-i\vec{k}\cdot\vec{r}_i} e^{i\vec{k}\cdot\vec{r}_j} = \delta_{ij},\quad \frac{1}{\sqrt{N}}\sum_{\vec{k}} e^{i\vec{k}_i \cdot\vec{r}_j} e^{-i\vec{k}_j \cdot\vec{r}_i} = \delta_{\vec{k}_i,\vec{k}_j}</script><p>代入后得到：</p>
<script type="math/tex; mode=display">\begin{aligned}
a^\dagger_{\vec{r}_a} b_{\vec{r}_b}&= \frac{1}{N}\sum_{\vec{k},\vec{k'}} e^{-i\vec{k}\cdot\vec{r}_A} e^{i\vec{k'}\cdot\vec{r}_B} a_{\vec{k}}^\dagger b_{\vec{k'}} \\
&= \frac{1}{N}\sum_{\vec{k},\vec{k'}} e^{i(\vec{k}-\vec{k}')\cdot\vec{r}_A} e^{-i\vec{k'}\cdot(\vec{r}_A-\vec{r}_B)} a_{\vec{k}}^\dagger b_{\vec{k}} \\
&= \frac{1}{N}\sum_{\vec{k}}  e^{-i\vec{k'}\cdot(\vec{r}_A-\vec{r}_B)} a_{\vec{k}}^\dagger b_{\vec{k}} \\
\end{aligned}</script><p>则哈密顿简化为：</p>
<script type="math/tex; mode=display">\begin{aligned}
\hat H &=-t\sum_{\langle i,j\rangle} (a^\dagger b_{\vec{e}_1}+ a^\dagger b_{\vec{e}_2} + a^\dagger b_{\vec{e}_3}+ h.c.) \\
&= -t\sum_{\vec{k}} \left( e^{i\vec{k}\cdot\vec{e}_1} + e^{i\vec{k}\cdot\vec{e}_2} + e^{i\vec{k}\cdot\vec{e}_3} \right) a_{\vec{k}}^\dagger b_{\vec{k}} + h.c. \\
\end{aligned}</script><p>将其写成矩阵形式：</p>
<script type="math/tex; mode=display">\hat H = \sum_{\vec{k}} \begin{pmatrix} a_{\vec{k}}^\dagger & b_{\vec{k}}^\dagger \end{pmatrix} \begin{pmatrix} 0 & -t(e^{i\vec{k}\cdot\vec{e}_1} + e^{i\vec{k}\cdot\vec{e}_2} + e^{i\vec{k}\cdot\vec{e}_3}) \\ -t(e^{-i\vec{k}\cdot\vec{e}_1} + e^{-i\vec{k}\cdot\vec{e}_2} + e^{-i\vec{k}\cdot\vec{e}_3}) & 0 \end{pmatrix} \begin{pmatrix} a_{\vec{k}} \\ b_{\vec{k}} \end{pmatrix}</script><p>代入三个原子的坐标：</p>
<script type="math/tex; mode=display">\begin{cases}
\vec{e}_1 = \left(0, a\right) \\
\vec{e}_2 = \left(\frac{\sqrt{3}}{2} a, -\frac{1}{2} a\right) \\
\vec{e}_3 = \left(-\frac{\sqrt{3}}{2} a, -\frac{1}{2} a\right)
\end{cases}</script><p>求解矩阵的特征值：</p>
<script type="math/tex; mode=display">\epsilon(\vec{k}) = \pm t \sqrt{3 + 2\cos(\sqrt{3}k_x a) + 4\cos\left(\frac{\sqrt{3}k_x a}{2}\right)\cos\left(\frac{3k_y a}{2}\right)}</script><p>这里的$a$是晶格常数。代入K点坐标$(\frac{2\pi}{3\sqrt3a}, \frac{2\pi}{3a})$，得到：</p>
<script type="math/tex; mode=display">\epsilon(\vec{k}) = 0</script><p>这就是狄拉克点（锥）。由于此处的色散关系为线性$E\propto |k|$，那么态密度也是线性的（这是由于石墨烯是二维材料）：</p>
<script type="math/tex; mode=display">\rho\propto \frac{2\pi k}{\nabla E}\propto E</script><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> curve_fit</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置中文字体</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数设置</span></span><br><span class="line">t = <span class="number">2.8</span>  <span class="comment"># 跃迁积分 (eV)</span></span><br><span class="line">a = <span class="number">1.42</span>  <span class="comment"># 碳原子间距 (Å)</span></span><br><span class="line">Nk = <span class="number">500</span>  <span class="comment"># k空间网格点数</span></span><br><span class="line">Nbins = <span class="number">500</span>  <span class="comment"># 能量分箱数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成k空间网格 (六边形布里渊区)</span></span><br><span class="line">kx = np.linspace(-<span class="number">2</span>*np.pi/(np.sqrt(<span class="number">3</span>)*a), <span class="number">2</span>*np.pi/(np.sqrt(<span class="number">3</span>)*a), Nk)</span><br><span class="line">ky = np.linspace(-<span class="number">2</span>*np.pi/(<span class="number">3</span>*a), <span class="number">2</span>*np.pi/(<span class="number">3</span>*a), Nk)</span><br><span class="line">kx, ky = np.meshgrid(kx, ky)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 石墨烯能带函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">graphene_band</span>(<span class="params">kx, ky, t, a</span>):</span><br><span class="line">    phase = np.cos(np.sqrt(<span class="number">3</span>)*kx*a)+<span class="number">2</span>*np.cos(np.sqrt(<span class="number">3</span>)*kx*a/<span class="number">2</span>)*np.cos(<span class="number">3</span>*ky*a/<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> t * np.sqrt(<span class="number">3</span> + <span class="number">2</span>*phase)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算能带能量</span></span><br><span class="line">E_upper = graphene_band(kx, ky, t, a)  <span class="comment"># 导带</span></span><br><span class="line">E_lower = -E_upper  <span class="comment"># 价带</span></span><br><span class="line">E = np.concatenate([E_upper.flatten(), E_lower.flatten()])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算态密度</span></span><br><span class="line">E_range = np.linspace(-<span class="number">3.1</span>*t, <span class="number">3.1</span>*t, Nbins)</span><br><span class="line">dos = np.zeros_like(E_range)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Nbins-<span class="number">1</span>):</span><br><span class="line">    mask = (E &gt;= E_range[i]) &amp; (E &lt; E_range[i+<span class="number">1</span>])</span><br><span class="line">    dos[i] = np.<span class="built_in">sum</span>(mask)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 归一化</span></span><br><span class="line">dos = dos / np.<span class="built_in">max</span>(dos)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 创建包含三个子图的图形</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 子图1: 能带结构 (左)</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 高对称路径 K→Γ→M→K</span></span><br><span class="line">k_path = np.array([</span><br><span class="line">    [<span class="number">2</span>*np.pi/(<span class="number">3</span>*np.sqrt(<span class="number">3</span>)*a), <span class="number">2</span>*np.pi/(<span class="number">3</span>*a)],  <span class="comment"># K点</span></span><br><span class="line">    [<span class="number">0</span>, <span class="number">0</span>],                                      <span class="comment"># Γ点</span></span><br><span class="line">    [<span class="number">0</span>, <span class="number">2</span>*np.pi/(<span class="number">3</span>*a)],                         <span class="comment"># M点</span></span><br><span class="line">    [<span class="number">2</span>*np.pi/(<span class="number">3</span>*np.sqrt(<span class="number">3</span>)*a), <span class="number">2</span>*np.pi/(<span class="number">3</span>*a)]   <span class="comment"># K点</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">n_points = <span class="number">100</span></span><br><span class="line">k_band = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(k_path)-<span class="number">1</span>):</span><br><span class="line">    k_band.extend(np.linspace(k_path[i], k_path[i+<span class="number">1</span>], n_points))</span><br><span class="line">k_band = np.array(k_band)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算能带</span></span><br><span class="line">E_band = graphene_band(k_band[:,<span class="number">0</span>], k_band[:,<span class="number">1</span>], t, a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制能带</span></span><br><span class="line">x_axis = np.arange(<span class="built_in">len</span>(k_band))</span><br><span class="line">plt.plot(x_axis, E_band, <span class="string">&#x27;r-&#x27;</span>, label=<span class="string">&#x27;导带&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line">plt.plot(x_axis, -E_band, <span class="string">&#x27;b-&#x27;</span>, label=<span class="string">&#x27;价带&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标记高对称点</span></span><br><span class="line">high_sym_pos = [<span class="number">0</span>, n_points, <span class="number">2</span>*n_points, <span class="number">3</span>*n_points-<span class="number">1</span>]</span><br><span class="line">high_sym_labels = [<span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;Γ&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;K&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pos, label <span class="keyword">in</span> <span class="built_in">zip</span>(high_sym_pos, high_sym_labels):</span><br><span class="line">    plt.axvline(x_axis[pos], color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">plt.xticks([x_axis[pos] <span class="keyword">for</span> pos <span class="keyword">in</span> high_sym_pos], high_sym_labels)</span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="built_in">len</span>(x_axis)-<span class="number">1</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;能量 (eV)&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;(a) 石墨烯能带结构 (K→Γ→M→K路径)&#x27;</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 子图2: 态密度 (中)</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制态密度曲线</span></span><br><span class="line">plt.plot(E_range, dos, <span class="string">&#x27;k-&#x27;</span>, lw=<span class="number">2</span>, label=<span class="string">&#x27;态密度&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在狄拉克点附近进行线性拟合</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">linear_func</span>(<span class="params">x, a</span>):</span><br><span class="line">    <span class="keyword">return</span> a * np.<span class="built_in">abs</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择狄拉克点附近的区域 (±1 eV)</span></span><br><span class="line">mask = (E_range &gt; -<span class="number">1</span>) &amp; (E_range &lt; <span class="number">1</span>)</span><br><span class="line">mask_plot = (E_range &gt; -<span class="number">3</span>) &amp; (E_range &lt; <span class="number">3</span>)</span><br><span class="line">popt, _ = curve_fit(linear_func, E_range[mask], dos[mask])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制拟合曲线</span></span><br><span class="line">plt.plot(E_range[mask_plot], linear_func(E_range[mask_plot], *popt), <span class="string">&#x27;b--&#x27;</span>, </span><br><span class="line">         label=<span class="string">&#x27;线性拟合 (狄拉克点)&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">plt.axvline(<span class="number">0</span>, color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;能量 (eV)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;态密度 (归一化)&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;(b) 石墨烯电子态密度&#x27;</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">1.1</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line">plt.legend()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line"><span class="comment"># 子图3: 3D能带结构 (右)</span></span><br><span class="line"><span class="comment"># ========================================</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">6</span>, <span class="number">5</span>))</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">ax.set_box_aspect([<span class="number">1</span>, <span class="number">1</span>, <span class="number">0.7</span>])  <span class="comment"># 设置长宽高比</span></span><br><span class="line"><span class="comment"># 为3D绘图减少采样点</span></span><br><span class="line">nk_3d = <span class="number">50</span></span><br><span class="line">kx_3d = np.linspace(-<span class="number">2</span>*np.pi/(np.sqrt(<span class="number">3</span>)*a), <span class="number">2</span>*np.pi/(np.sqrt(<span class="number">3</span>)*a), nk_3d)</span><br><span class="line">ky_3d = np.linspace(-<span class="number">2</span>*np.pi/(<span class="number">3</span>*a), <span class="number">2</span>*np.pi/(<span class="number">3</span>*a), nk_3d)</span><br><span class="line">KX, KY = np.meshgrid(kx_3d, ky_3d)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算能带</span></span><br><span class="line">E_3d = graphene_band(KX, KY, t, a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制3D能带</span></span><br><span class="line">surf1 = plt.gca().plot_surface(KX, KY, E_3d, cmap=<span class="string">&#x27;viridis&#x27;</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line">surf2 = plt.gca().plot_surface(KX, KY, -E_3d, cmap=<span class="string">&#x27;plasma&#x27;</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制费米面</span></span><br><span class="line">plt.gca().plot_surface(KX, KY, np.zeros_like(KX), color=<span class="string">&#x27;gray&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;$k_x$&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;$k_y$&#x27;</span>)</span><br><span class="line">plt.xticks(np.linspace(-<span class="number">2</span>*np.pi/(<span class="number">3</span>*a), <span class="number">2</span>*np.pi/(<span class="number">3</span>*a), <span class="number">3</span>), [<span class="string">r&#x27;$-\frac&#123;2\pi&#125;&#123;3a&#125;$&#x27;</span>, <span class="string">r&#x27;$0$&#x27;</span>, <span class="string">r&#x27;$\frac&#123;2\pi&#125;&#123;3a&#125;$&#x27;</span>])</span><br><span class="line">plt.yticks(np.linspace(-<span class="number">2</span>*np.pi/(<span class="number">3</span>*a), <span class="number">2</span>*np.pi/(<span class="number">3</span>*a), <span class="number">3</span>), [<span class="string">r&#x27;$-\frac&#123;2\pi&#125;&#123;3a&#125;$&#x27;</span>, <span class="string">r&#x27;$0$&#x27;</span>, <span class="string">r&#x27;$\frac&#123;2\pi&#125;&#123;3a&#125;$&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;(c) 石墨烯3D能带结构&#x27;</span>)</span><br><span class="line">plt.gca().view_init(elev=<span class="number">30</span>, azim=<span class="number">45</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="\img\固体物理\石墨烯能带.png" alt="alt"></p>
<p><img src="\img\固体物理\石墨烯态密度.png" alt="alt"></p>
<h2><span id="紧束缚近似下碳纳米管的能带电子密度">紧束缚近似下碳纳米管的能带电子密度</span></h2><p>石墨烯卷曲可以得到碳纳米管。根据卷曲方向的不同，称为$(n,m)$型碳纳米管（如图所示）。其中：</p>
<ul>
<li>Zig-Zag型：$(n,0)$</li>
<li>Armchair型：$(n,n)$</li>
</ul>
<p><img src="\img\固体物理\碳纳米管.png" alt="alt"></p>
<p>具体的能带结构计算不再赘述，这里直接给出能带图和态密度图：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> curve_fit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置中文字体</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本参数</span></span><br><span class="line">t = <span class="number">2.8</span>  <span class="comment"># 跃迁积分 (eV)</span></span><br><span class="line">a = <span class="number">1.42</span>  <span class="comment"># 碳原子间距 (Å)</span></span><br><span class="line">Nk = <span class="number">400</span>  <span class="comment"># k空间网格点数</span></span><br><span class="line">Nbins = <span class="number">200</span>  <span class="comment"># 能量分箱数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ============================</span></span><br><span class="line"><span class="comment"># 1. Zigzag碳纳米管 (n,0)</span></span><br><span class="line"><span class="comment"># ============================</span></span><br><span class="line">n_zz = <span class="number">10</span>   <span class="comment"># 可调，越大越接近石墨烯</span></span><br><span class="line">m_zz = np.arange(n_zz)  <span class="comment"># m=0,1,...,n-1</span></span><br><span class="line">ky_zz = np.linspace(-np.pi/a, np.pi/a, Nk)  <span class="comment"># 轴向波矢</span></span><br><span class="line"></span><br><span class="line">E_zz_all = []</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> m_zz:</span><br><span class="line">    phase = np.cos(np.sqrt(<span class="number">3</span>)*ky_zz*a) + <span class="number">2</span> * np.cos(np.sqrt(<span class="number">3</span>)*ky_zz*a/<span class="number">2</span>) * np.cos(<span class="number">3</span>*np.pi*m/n_zz)</span><br><span class="line">    E_zz = t * np.sqrt(<span class="number">3</span> + <span class="number">2</span>*phase)</span><br><span class="line">    E_zz_all.append(E_zz)</span><br><span class="line">E_zz_all = np.array(E_zz_all)  <span class="comment"># (n, Nk)</span></span><br><span class="line">E_zz_flat = np.concatenate([E_zz_all.flatten(), -E_zz_all.flatten()])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 态密度</span></span><br><span class="line">E_range_zz = np.linspace(-<span class="number">3.1</span> * t, <span class="number">3.1</span> * t, Nbins)</span><br><span class="line">dos_zz = np.zeros_like(E_range_zz)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Nbins-<span class="number">1</span>):</span><br><span class="line">    mask = (E_zz_flat &gt;= E_range_zz[i]) &amp; (E_zz_flat &lt; E_range_zz[i+<span class="number">1</span>])</span><br><span class="line">    dos_zz[i] = np.<span class="built_in">sum</span>(mask)</span><br><span class="line">dos_zz = dos_zz / np.<span class="built_in">max</span>(dos_zz)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ============================</span></span><br><span class="line"><span class="comment"># 2. Armchair碳纳米管 (n,n)</span></span><br><span class="line"><span class="comment"># ============================</span></span><br><span class="line">n_ac = <span class="number">10</span>  <span class="comment"># 可调</span></span><br><span class="line">m_ac = np.arange(n_ac)</span><br><span class="line">ky_ac = np.linspace(-np.pi/(np.sqrt(<span class="number">3</span>)*a), np.pi/(np.sqrt(<span class="number">3</span>)*a), Nk)  <span class="comment"># 轴向波矢</span></span><br><span class="line"></span><br><span class="line">E_ac_all = []</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> m_ac:</span><br><span class="line">    phase = np.cos(<span class="number">2</span>*np.pi*m/n_ac) + <span class="number">2</span> * np.cos(np.pi*m/n_ac) * np.cos(<span class="number">3</span>*ky_ac*a/<span class="number">2</span>)</span><br><span class="line">    E_ac = t * np.sqrt(<span class="number">3</span> + <span class="number">2</span>*phase)</span><br><span class="line">    E_ac_all.append(E_ac)</span><br><span class="line">E_ac_all = np.array(E_ac_all)</span><br><span class="line">E_ac_flat = np.concatenate([E_ac_all.flatten(), -E_ac_all.flatten()])</span><br><span class="line"></span><br><span class="line">E_range_ac = np.linspace(-<span class="number">3.1</span> * t, <span class="number">3.1</span> * t, Nbins)</span><br><span class="line">dos_ac = np.zeros_like(E_range_ac)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Nbins-<span class="number">1</span>):</span><br><span class="line">    mask = (E_ac_flat &gt;= E_range_ac[i]) &amp; (E_ac_flat &lt; E_range_ac[i+<span class="number">1</span>])</span><br><span class="line">    dos_ac[i] = np.<span class="built_in">sum</span>(mask)</span><br><span class="line">dos_ac = dos_ac / np.<span class="built_in">max</span>(dos_ac)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ============================</span></span><br><span class="line"><span class="comment"># 绘图</span></span><br><span class="line"><span class="comment"># ============================</span></span><br><span class="line">fig, axs = plt.subplots(<span class="number">2</span>, <span class="number">2</span>, figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- Zigzag 能带 ----</span></span><br><span class="line">ax = axs[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(n_zz):</span><br><span class="line">    ax.plot(ky_zz, E_zz_all[m], color=<span class="string">&#x27;r&#x27;</span>, lw=<span class="number">0.8</span>)</span><br><span class="line">    ax.plot(ky_zz, -E_zz_all[m], color=<span class="string">&#x27;b&#x27;</span>, lw=<span class="number">0.8</span>)</span><br><span class="line">ax.set_title(<span class="string">f&quot;(a) Zigzag碳纳米管(n=<span class="subst">&#123;n_zz&#125;</span>,0) 能带&quot;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">r&quot;$k_y$ 埃&quot;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&quot;能量 (eV)&quot;</span>)</span><br><span class="line">ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- Zigzag 态密度 ----</span></span><br><span class="line">ax = axs[<span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">ax.plot(E_range_zz, dos_zz, <span class="string">&#x27;k-&#x27;</span>, lw=<span class="number">2</span>, label=<span class="string">&#x27;态密度&#x27;</span>)</span><br><span class="line"><span class="comment"># 狄拉克点线性拟合</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">linear_func</span>(<span class="params">x, a</span>): <span class="keyword">return</span> a * np.<span class="built_in">abs</span>(x)</span><br><span class="line">mask = (E_range_zz &gt; -<span class="number">1</span>) &amp; (E_range_zz &lt; <span class="number">1</span>)</span><br><span class="line">mask_plot = (E_range_zz &gt; -<span class="number">3</span>) &amp; (E_range_zz &lt; <span class="number">3</span>)</span><br><span class="line">ax.axvline(<span class="number">0</span>, color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;能量 (eV)&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;态密度 (归一化)&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&quot;(b) Zigzag碳纳米管 态密度&quot;</span>)</span><br><span class="line">ax.legend()</span><br><span class="line">ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- Armchair 能带 ----</span></span><br><span class="line">ax = axs[<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(n_ac):</span><br><span class="line">    ax.plot(ky_ac, E_ac_all[m], color=<span class="string">&#x27;r&#x27;</span>, lw=<span class="number">0.8</span>)</span><br><span class="line">    ax.plot(ky_ac, -E_ac_all[m], color=<span class="string">&#x27;b&#x27;</span>, lw=<span class="number">0.8</span>)</span><br><span class="line">ax.set_title(<span class="string">f&quot;(c) Armchair碳纳米管(n=<span class="subst">&#123;n_ac&#125;</span>,<span class="subst">&#123;n_ac&#125;</span>) 能带&quot;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">r&quot;$k_y$ 埃&quot;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&quot;能量 (eV)&quot;</span>)</span><br><span class="line">ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- Armchair 态密度 ----</span></span><br><span class="line">ax = axs[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">ax.plot(E_range_ac, dos_ac, <span class="string">&#x27;k-&#x27;</span>, lw=<span class="number">2</span>, label=<span class="string">&#x27;态密度&#x27;</span>)</span><br><span class="line">mask = (E_range_ac &gt; -<span class="number">1</span>) &amp; (E_range_ac &lt; <span class="number">1</span>)</span><br><span class="line">mask_plot = (E_range_ac &gt; -<span class="number">3</span>) &amp; (E_range_ac &lt; <span class="number">3</span>)</span><br><span class="line">ax.axvline(<span class="number">0</span>, color=<span class="string">&#x27;gray&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;能量 (eV)&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;态密度 (归一化)&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&quot;(d) Armchair碳纳米管 态密度&quot;</span>)</span><br><span class="line">ax.legend()</span><br><span class="line">ax.grid(<span class="literal">True</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="\img\固体物理\碳纳米管能带.png" alt="alt"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xuxu20040407.github.io">Xuxu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xuxu20040407.github.io/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E8%83%BD%E5%B8%A6%E8%AE%BA/">https://xuxu20040407.github.io/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E8%83%BD%E5%B8%A6%E8%AE%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xuxu20040407.github.io" target="_blank">小径</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/">固体物理</a></div><div class="post_share"><div class="social-share" data-image="/img/cover2.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E9%87%91%E5%B1%9E%E7%94%B5%E5%AD%90%E8%AE%BA/" title="金属电子论"><img class="cover" src="/img/cover4.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">金属电子论</div></div></a></div><div class="next-post pull-right"><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E6%99%B6%E6%A0%BC%E5%8A%A8%E5%8A%9B%E5%AD%A6/" title="晶格动力学"><img class="cover" src="/img/cover1.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">晶格动力学</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/06/13/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/Bloch%E7%94%B5%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/" title="Bloch电子动力学"><img class="cover" src="/img/cover5.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-13</div><div class="title">Bloch电子动力学</div></div></a></div><div><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E9%87%91%E5%B1%9E%E7%94%B5%E5%AD%90%E8%AE%BA/" title="金属电子论"><img class="cover" src="/img/cover4.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-22</div><div class="title">金属电子论</div></div></a></div><div><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E6%99%B6%E6%A0%BC%E5%8A%A8%E5%8A%9B%E5%AD%A6/" title="晶格动力学"><img class="cover" src="/img/cover1.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-22</div><div class="title">晶格动力学</div></div></a></div><div><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E6%99%B6%E4%BD%93%E7%9A%84%E7%BB%93%E5%90%88/" title="晶体的结合"><img class="cover" src="/img/cover5.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-22</div><div class="title">晶体的结合</div></div></a></div><div><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E6%99%B6%E4%BD%93%E7%BB%93%E6%9E%84/" title="晶体结构及其平移对称性"><img class="cover" src="/img/cover1.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-22</div><div class="title">晶体结构及其平移对称性</div></div></a></div><div><a href="/2025/02/22/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86/%E5%9B%BA%E4%BD%93%E7%89%A9%E7%90%86Content/" title="固体物理绪论"><img class="cover" src="/img/cover4.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-22</div><div class="title">固体物理绪论</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Xuxu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xuxu20040407"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Bloch定理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text">能谱结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">平面波法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">近自由电子近似</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.1.</span> <span class="toc-text">零级近似</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.2.</span> <span class="toc-text">一级近似的非简并微扰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.3.</span> <span class="toc-text">简并微扰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.4.</span> <span class="toc-text">布里渊区与能隙</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.5.</span> <span class="toc-text">近似简并微扰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">紧束缚近似</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">4.1.</span> <span class="toc-text">万尼尔函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">4.2.</span> <span class="toc-text">紧束缚近似假设</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">正交平面波方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">赝势方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">能带电子密度</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">7.1.</span> <span class="toc-text">自由电子的能态密度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">7.2.</span> <span class="toc-text">紧束缚近似三维简单立方晶体的能带电子密度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">7.3.</span> <span class="toc-text">紧束缚近似下石墨烯的能带电子密度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">7.4.</span> <span class="toc-text">紧束缚近似下碳纳米管的能带电子密度</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/18/%E5%A4%8F%E4%BB%A4%E8%90%A5%E5%A4%8D%E4%B9%A0/%E6%80%BB%E7%BB%93/" title="总结"><img src="/img/cover2.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="总结"/></a><div class="content"><a class="title" href="/2025/08/18/%E5%A4%8F%E4%BB%A4%E8%90%A5%E5%A4%8D%E4%B9%A0/%E6%80%BB%E7%BB%93/" title="总结">总结</a><time datetime="2025-08-18T03:51:33.000Z" title="发表于 2025-08-18 11:51:33">2025-08-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/12/%E7%90%86%E8%AE%BA%E5%8A%9B%E5%AD%A6/%E7%9B%B8%E5%AF%B9%E8%AE%BA%E5%8A%9B%E5%AD%A6/" title="相对论力学"><img src="/img/cover2.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="相对论力学"/></a><div class="content"><a class="title" href="/2025/08/12/%E7%90%86%E8%AE%BA%E5%8A%9B%E5%AD%A6/%E7%9B%B8%E5%AF%B9%E8%AE%BA%E5%8A%9B%E5%AD%A6/" title="相对论力学">相对论力学</a><time datetime="2025-08-12T06:11:36.000Z" title="发表于 2025-08-12 14:11:36">2025-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/10/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/WKB-Approximation/" title="WKB-Approximation"><img src="/img/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/%E6%B3%A2%E5%87%BD%E6%95%B0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WKB-Approximation"/></a><div class="content"><a class="title" href="/2025/08/10/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/WKB-Approximation/" title="WKB-Approximation">WKB-Approximation</a><time datetime="2025-08-10T08:27:46.000Z" title="发表于 2025-08-10 16:27:46">2025-08-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/10/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/Time-Dependent-Perturbation/" title="Time-Dependent-Perturbation"><img src="/img/cover1.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Time-Dependent-Perturbation"/></a><div class="content"><a class="title" href="/2025/08/10/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/Time-Dependent-Perturbation/" title="Time-Dependent-Perturbation">Time-Dependent-Perturbation</a><time datetime="2025-08-10T06:45:28.000Z" title="发表于 2025-08-10 14:45:28">2025-08-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/08/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/Density-Matrix/" title="Density-Matrix"><img src="/img/cover4.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Density-Matrix"/></a><div class="content"><a class="title" href="/2025/08/08/%E9%87%8F%E5%AD%90%E5%8A%9B%E5%AD%A62/Density-Matrix/" title="Density-Matrix">Density-Matrix</a><time datetime="2025-08-08T06:43:11.000Z" title="发表于 2025-08-08 14:43:11">2025-08-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Xuxu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true}});</script></body></html>