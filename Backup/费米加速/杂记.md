---
title: 杂记
mathjax: true
date: 2024-09-04 15:31:00
tags:
- 天文 
- 科研
categories: 天文
cover:
---

>尚未解决的几大问题：
>
>1. 费米加速的代码模拟必须使用相对论变换，具体见下述推导。done
>
>2. 实现代码后，精度的划分是否有显著的影响，是否能够收敛？由于费米加速是按照次数加速，如何将其用于理论模型？
>
>3. 如何划分云团？这只对理论模型的建立有影响。
>
>4. 如何模拟后续的加速减速竞争？需要推导同步辐射的功率。
>
>5. 如何模拟射电晕的结构？需要推导$\gamma$和辐射功率的关系。

# 为什么一定要用相对论变换？
此前我认为云团的速度远小于光速，所以可以使用伽利略变换近似，这是**错误**的。如果使用伽利略变换：

假设云团的速度为$v_0$，电子的入射速度是$v_1$，出射速度是$v_2$，入射出射角度分别是$\theta_1,\theta_2$。则出射速度和入射速度的能量守恒关系为
$$(v_1\cos{\theta_1}-v_0)^2+(v_1\sin{\theta_1})^2=(v_2\cos{\theta_2}-v_0)^2+(v_2\sin{\theta_2})^2$$
化简有
$$v_1^2-2v_0v_1\cos{\theta_1}=v_2^2-2v_0v_2\cos{\theta_2}$$
$$v_2^2-2v_0v_2\cos{\theta_2}-v_1^2+2v_0v_1\cos{\theta_1}=0$$
求解$v_2$有：
$$v_2=v_0\cos{\theta_2}\pm\sqrt{v_0^2\cos^2{\theta_2}+v_1^2-2v_0v_1\cos{\theta_1}}$$
考虑到$v_1\gg v_0$，进行小量近似可得：
$$\delta v\propto \frac{v_0^2}{v_1}$$
$$\delta E\propto \frac{\delta v}{v_1} \propto \beta^2$$

这里假设了$\theta_2$与$\theta_1$无关，则$\theta_2$自由平均。这主要是基于电子的拉莫尔半径是
$$R=\frac{\gamma mv}{qB}= 1.7\times10^{7}\gamma(\frac{v}{1c})(\frac{B}{1\mu G})^{-1}m\approx 10^{10}m\ll 1pc=3\times 10^{16}m$$
>这说明云团的尺寸和局域磁场的尺寸有着较大的差别，局域磁场的尺寸应该远小于云团的尺寸（不然电子会一直打转）。



我们回到这个公式
$$v_2=v_0\cos{\theta_2}+\sqrt{v_0^2\cos^2{\theta_2}+v_1^2-2v_0v_1\cos{\theta_1}}=v_1+v_0(\cos{\theta_2}-\cos{\theta_1})+\frac{v_0^2\cos^2{\theta_2}}{2v_1}$$

这里其实是有问题的，小量近似本身是二阶精度，那么最后一项是不可以保留的。此外，倒数第二项的意义保证了只和头尾有关。对$\theta_1$和$\theta_2$进行数值积分，可以知道如果不进行小量近似，那么整体上是减速的。

这是因为虽然云团的速度远小于光速，但是高速粒子的速度却和光速差不多(0.999c)，如果使用伽利略变换，可能会导致粒子速度高于光速，这是不可能的。

# 保留小量的相对论变换
我们来估计相对论电子的$\gamma_e$系数，考虑到观测到的射电晕的频率在1-4GHz，并由
$$f=2\times 10^6 \gamma^2 (\frac{B}{1G})$$
可以估算出
$$\gamma_e>10^3$$

$\gamma_e$系数和动量，能量的换算关系：
$$E=\gamma_e m_0 c^2$$
$$E^2=p^2c^2+ m_0^2 c^4\Rightarrow p=\sqrt{\gamma_e^2-1}m_0c$$

Fermi的推导中用到了小量近似：
$$E^*_1=\gamma(E_1-\beta p_1\cos{\theta_1}c)=\gamma E_1(1-\beta \cos{\theta_1})$$

这个地方如果不使用小量近似：
$$E^*_1=\gamma(E_1-\beta p_1\cos{\theta_1}c)=\gamma m_0 c^2(\gamma_e-\beta \sqrt{\gamma_e^2-1}\cos{\theta_1})=\gamma E_1(1-\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_1})$$

相当于这个地方的小量近似误差为$O(\beta\gamma\gamma^{-2}_e m_0c^2)$，而费米加速的能量增加率为$\beta^2 \gamma_e m_0c^2$。我们关心这两个的数量级，幸运的是，看上去可以弥补这个误差。下面是详细的推导：

$$E^*_1=\gamma E_1(1-\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_1})$$
$$E_2=\gamma E_1^*(1+\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_2})$$

所以：
$$\begin{aligned}
	E_2&=\gamma^2 E_1(1-\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_1})(1+\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_2})\\
	&=\gamma^2 E_1(1-\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_1}+\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_2}-\beta^2(1-\gamma_e^{-2})\cos{\theta_1}\cos{\theta_2})
\end{aligned}$$

$$\begin{aligned}
	\langle \epsilon\rangle&=\gamma^2 (1-\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_1}+\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_2}-\beta^2(1-\gamma_e^{-2})\cos{\theta_1}\cos{\theta_2})-1\\
	&=\frac{\beta^2-\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_1}+\beta \sqrt{1-\gamma_e^{-2}}\cos{\theta_2}-\beta^2(1-\gamma_e^{-2})\cos{\theta_1}\cos{\theta_2}}{1-\beta^2}\\
	&=\frac{\beta^2(1-(1-\gamma_e^{-2})\cos{\theta_1}\cos{\theta_2})+\beta \sqrt{1-\gamma_e^{-2}}(\cos{\theta_2}-\cos{\theta_1})}{1-\beta^2}\\
    &\approx\frac{\beta^2\cos{\theta_1}\cos{\theta_2}+\beta (\cos{\theta_2}-\cos{\theta_1})}{1-\beta^2}
\end{aligned}$$

这和之前的推导是一致的。

# 相对论部分代码推导及其数量级

上面的模型或许可以用于解释或者建立解析模型，但是对于第一性的模拟来说却是不够的，第一点是划分精度决定加速效率的问题（下面再说），第二点就是在确定而非随机磁场中角度和速度大小的变化。

原本的速度变换公式为：

$${u^{\prime}}=\frac{\sqrt{1-v^2}{u}-\frac{1-\sqrt{1-v^2}}{v^2}({u}\cdot{v}){v}-{v}}{1-{u}\cdot{v}}$$

在新的参考系中，粒子做无能量耗散的圆周运动，其半径为
$$R=\frac{\gamma mv}{qB}$$

云团的尺寸假设为1pc，以光速运动的电子也需要3年的时间穿过，如果第一性原理计算量极大，而使用费米加速模型或许可以简化一些计算量。

转念一想，云团的尺寸大啊，我只需要在里面做一次相对论变换，至于怎么在磁场中转，这涉及到了磁场的模型，不如在足够大的情况下假设随机出射。（注意，是新系下的随机出射）

不对，还是得考虑随机偏转，因为出射角度可能和入射角度不独立。

由于云团的速度较小，忽略云团的移动。开始运动时，判断处于哪个云团，做相对论速度变换和位置变换。粒子仿照磁场偏转的办法，在其中做随机正态分布的偏转（记得$\times \gamma$），时间步为？



# 解析模型遇到的问题
1. 不是简单的扩散，加速度空间可以视为随机游走，但是速度是其一阶积分，位移是其二阶积分，最终呈现的效果有待计算。
2. 希望解析模型反应index和位置的关系。但是加速机制却和次数而不是和位置有关（见下），这里希望能有一个异于费米模型的模型，结合上面一点，在速度空间描述其变化，假定云团变成随机速度场，或许可以解决？
3. 基于射电晕有寿命且生成于并和时期的事实，如何反应湍流的程度影响加速效果？云团的平均速度大小，还是速度场的不均匀度（云团的个数）？


# 划分精度决定了加速效率？
云团内包含了方向各异的磁场，却有着统一的速度。但数据是速度场，对云团的划分精度会显著影响加速效果，这显然是违背物理的。我们需要考虑速度的缓变场。

# 代码遇到的问题
1. 在模拟磁场运动这一步遇到了极大的计算量，这是希望保留一定的第一性且试图抛开费米模型前后角度独立的假定。现在的想法是，由于每次的变化是一个小量，那么能不能整合timestep的大小（加一点解析的模型进去）。
2. 怎么验证这个代码结果的正确性？怎么证明现在的随机固定云团可以反应真实的情况。
