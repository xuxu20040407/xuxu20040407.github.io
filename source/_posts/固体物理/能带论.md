---
title: 能带论
mathjax: true
date: 2025-02-22 09:30:06
tags: 固体物理
categories: 固体物理
cover:
---


在金属电子论中，我们知道Drude模型做了如下假设：
- 独立电子近似：电子之间没有相互作用；
- 自由电子近似：电子和离子之间没有相互作用；
- 晶格碰撞阻力近似：用平均弛豫时间来描述。

Drude模型说明了欧姆定律的正确性，但是无法解释电子具有很长的自由程（这当然是由于Drude模型做了独立电子近似和自由电子近似）。考虑电子与电子相互作用，可以得到金属的费米气理论；考虑电子与离子相互作用，可以得到能带论。

对于晶体中的多体问题，其哈密顿量为：
$$H=\sum_i\frac{\vec{p_i}^2}{2m_e}+\sum_n\frac{\vec{p_n}^2}{2M_n}+\frac12\sum_{i\neq j}\frac{e^2}{|\vec{r_i}-\vec{r_j}|}+\frac12\sum_{n\neq m}\frac{Z_nZ_m e^2}{|\vec{R_n}-\vec{R_m}|}+\sum_{i,n}\frac{eZ_n}{|\vec{r_i}-\vec{R_n}|}$$

能带论做出了以下假设：
- 绝热近似：处理电子问题时，认为离子实在格点上固定不动；
  $$H_e=\sum_i\left(\frac{\vec{p_i}^2}{2m_e}+\sum_nV_n(\vec{r_i}-\vec{R_n})\right)+\frac12\sum_{i\neq j}\frac{e^2}{|\vec{r_i}-\vec{r_j}|}\\
  \text{Fix}\quad H_n=\sum_n\frac{\vec{p_n}^2}{2M_n}+\frac12\sum_{n\neq m}\frac{Z_nZ_m e^2}{|\vec{R_n}-\vec{R_m}|}+V_{e-c}$$
  在上述假设中，电子和离子实被分开，即电声无耦合。
- 单电子近似：用平均场来代替电子电子间和电子离子间的相互作用；
  $$H_e=\sum_i\left(\frac{\vec{p_i}^2}{2m_e}+V(\vec{r},\{\vec{R_n}\})\right)$$
- 周期场近似：平均场是周期性势场。
  $$V(\vec{r},\{\vec{R_n}\})=V(\vec{r})=V(\vec{r}+\vec{R_n}),\quad R_n=\sum_i n_ia_i$$

这样，能带论的核心问题就是求解以下周期势场的单电子问题：
$$[-\frac{\hbar^2}{2m}\nabla^2+V(r)]\psi(r)=E\psi(r)$$
这和我们在量子力学中求解的周期势场问题是相同的。一种严格解法是平面波法，两种近似解法为近自由电子近似和紧束缚近似。如何选择两种近似方法，得看材料中的电子表现更像波还是粒子，进一步，是在周期势场中穿梭还是被束缚在原子附近。


# Bloch定理
周期势场中的哈密顿量是正格矢的周期函数，那么波函数也是吗？并非。考虑周期场中单电子的波函数为$\psi_k^n(\vec{r})$，显然平移后的波函数为：
$$\begin{aligned}
\psi_k^n(\vec{r}+\vec{R})&=\prod_i\hat{T}^{l_i}(a_i)\psi_k^n(\vec{r})\\
&=\prod_i \exp{\frac{i\hat p a_il_i}{\hbar}}\psi_k^n(\vec{r})\\
&=e^{i\vec{k}\cdot\vec{R}}\psi_k^n(\vec{r})
\end{aligned}$$

考虑玻恩-冯卡门边界条件：
$$e^{i (\sum_iN_ik_ia_i)}=1\Rightarrow k_i=2\pi \frac{h_i}{N_i a_i},h_i=0,1,2,\cdots,N_i-1$$
或者写为分量的形式：
$$\vec{k}=\sum_i k_i\vec{b_i},k_i=\frac{h_i}{N_i}$$

将波函数拆开，根据Bloch定理，其相位函数可以确定，振幅函数同样也是一个周期函数：
$$\psi_k^n(\vec{r})=e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})$$
这种波函数$u_k^n(\vec{r})$称为布洛赫波函数。

## 能谱结构
0. 写出能量本征值方程，并对其作规范变化：
    $$\begin{aligned}
    &[-\frac{\hbar^2}{2m}\nabla^2+V(r)]e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})=E_n(\vec{k})e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})\\
    \Rightarrow&e^{-i\vec{k}\cdot\vec{r}}[-\frac{\hbar^2}{2m}\nabla^2+V(r)]e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})=e^{-i\vec{k}\cdot\vec{r}}E_n(\vec{k})e^{i\vec{k}\cdot\vec{r}}u_k^n(\vec{r})\\
    \Rightarrow&[-\frac{\hbar^2}{2m}(\nabla-i\vec{k})^2+V(r)]u_k^n(\vec{r})=E_n(\vec{k})u_k^n(\vec{r})\\
    \end{aligned}$$
    记$\hat H_k=-\frac{\hbar^2}{2m}(\nabla-i\vec{k})^2+V(r)$，其仍然是一个厄米算符。
1. 对于确定的$\vec{k}$，由Sturm-Liouville定理，有无数个分立的能量本征值$E_n(\vec{k})$。
2. 对于确定的$n$，能量本征值$E_n(\vec{k})$是一个周期函数，即$E_n(\vec{k})=E_n(\vec{k}+\vec{K_h})$，其中$\vec{K_h}$是倒格矢。这说明能带的计算可以在一个布里渊区内完成。
3. 显然，由于周期性，确定的$n$对应的能量本征值$E_n(\vec{k})$是一个能带（有上下界）；
4. 由于玻恩-冯卡门边界条件，$\vec{k}$的取值是离散的，所以能带在$\vec{k}$轴上是分立的。但是，由于宏观晶体的尺寸较大，$\vec{k}$的取值是准连续的。

![能带结构](\img\固体物理\3.png)

# 平面波法
利用平面波分解可以严格求解周期势场中的单电子薛定谔方程问题。将单电子波函数用倒格矢展开：
$$\psi_k(r)=u_k(r)e^{i\vec{k}·\vec{r}},u_k(r)=\frac{1}{\sqrt{N\Omega}}\sum_h a_k(\vec{K_h})e^{i\vec{K_h}·\vec{r}}$$

其中，平面波展开的系数为：
$$\begin{aligned}
a_k(\vec{K_h})&=\frac{1}{\sqrt{N\Omega}}\int u_k(r)e^{-i\vec{K_h}·r}dr\\
&=\frac{1}{\sqrt{N\Omega}}\int \psi_k(r)e^{-i(\vec{k}+\vec{K_h})·\vec{r}}dr\\
&=\frac{1}{\sqrt{N\Omega}}\int \psi_{k+K_h}(r)e^{-i(\vec{k}+\vec{K_h})·\vec{r}}dr\\
&=a(\vec{k}+\vec{K_h})
\end{aligned}$$
最终波函数可以写为：
$$\psi_k(r)=\frac{1}{\sqrt{N\Omega}}\sum_h a(\vec{k}+\vec{K_h})e^{i(\vec{k}+\vec{K_h})·\vec{r}}$$
$$|\psi_k\rangle=\sum_h a(\vec{k}+\vec{K_h})|\vec{k}+\vec{K_h}\rangle，|\vec{k}+\vec{K_h}\rangle=\frac{1}{\sqrt{N\Omega}} e^{i(\vec{k}+\vec{K_h})·\vec{r}}$$

代入波动方程中，并在左侧作用$\langle \vec{k}+\vec{K_{h'}}|$得到：
$$\begin{aligned}
&\langle \vec{k}+\vec{K_{h'}}|\sum_ha(\vec{k}+\vec{K_h})[\hat H-E(\vec{k})]|\vec{k}+\vec{K_h}\rangle\\
=&\sum_h \langle \vec{k}+\vec{K_{h'}}|(-\frac{\hbar^2}{2m}\nabla^2+V(r)-E(\vec{k}))|\vec{k}+\vec{K_h}\rangle\\
=&[\frac{\hbar^2}{2m}(\vec{k}+\vec{K_{h'}})^2-E(\vec{k})]a(\vec{k}+\vec{K_{h'}})+\sum_h \langle \vec{k}+\vec{K_{h'}}|V(r)|\vec{k}+\vec{K_h}\rangle a(\vec{k}+\vec{K_h})\\
=&[\frac{\hbar^2}{2m}(\vec{k}+\vec{K_{h'}})^2-E(\vec{k})]a(\vec{k}+\vec{K_{h'}})+\sum_{h\neq h'} V(\vec{K_{h'}}-\vec{K_h}) a(\vec{k}+\vec{K_h})\\
=&0
\end{aligned}$$

> 其中，对于势能的计算来自于：
> $$\begin{aligned}
\langle \vec{k}+\vec{K_{h'}}|V(r)|\vec{k}+\vec{K_h}\rangle&=\frac{1}{N\Omega}\int V(r)e^{-i(\vec{k}+\vec{K_{h'}})·\vec{r}}e^{i(\vec{k}+\vec{K_h})·\vec{r}}dr\\
&=\frac{1}{N\Omega}\int V(r)e^{-i(\vec{K_{h'}}-\vec{K_h})·\vec{r}}dr\\
&=V(\vec{K_{h'}}-\vec{K_h})
\end{aligned}$$
> 这正是周期势的傅里叶展开：
> $$V(\vec{r})=\sum_h V(\vec{K_h})e^{i\vec{K_h}·\vec{r}}=\bar{V}|_{h=0}+\sum_{h\neq 0} V(\vec{K_h})e^{i\vec{K_h}·\vec{r}}$$
> 一般取$\bar{V}=0$。


至此，我们问题转化为线性齐次方程组的问题。利用行列式为0，可以求解能量本征值的方程：
$$\det{H_{\vec{K_h},\vec{K_{h'}}}}=0$$
其中$H_{\vec{K_h},\vec{K_{h'}}}$为：
$$H_{\vec{K_h},\vec{K_{h'}}}=\begin{cases}\frac{\hbar^2}{2m}(\vec{k}+\vec{K_{h'}})^2-E(\vec{k}),&\vec{K_h}=\vec{K_{h'}}\\V(\vec{K_h}-\vec{K_{h'}}),&\vec{K_h}\neq \vec{K_{h'}}\end{cases}$$



# 近自由电子近似
尽管平面波是严格求解周期势场中单电子薛定谔方程的方法，但在高阶行列式中，求解往往是难以收敛的。考虑势场的空间变化十分微弱，我们使用量子力学中的微扰论来处理。这时候电子的行为十分接近自由电子，这就是近自由电子近似：
$$V(\vec{r})=\bar{V}+\Delta V(\vec{r})$$

## 零级近似
如果做零级近似，即$\Delta V=0$，代入平均场，电子的本征解即为平面波解：
$$\psi_k^0(\vec{r})=\frac{1}{\sqrt{N\Omega}}e^{i\vec{k}\vec{r}},E_k^0=\frac{\hbar^2k^2}{2m}+\bar V$$

## 一级近似的非简并微扰

将波函数写为：
$$\psi_k(\vec{r})=\frac{a(\vec{k})}{\sqrt{N\Omega}}e^{i\vec{k}\vec{r}}+\sum_{h\neq 0}\frac{a(\vec{k}+\vec{K_h})}{\sqrt{N\Omega}}e^{i(\vec{k}+\vec{K_h})\vec{r}}$$
依照微扰理论，可以计算出一阶微扰：
$$a(\vec{k})=1,a(\vec{k}+\vec{K_h})=\frac{V(\vec{K_h})}{\frac{\hbar^2}{2m}[\vec{k}^2-(\vec{k}+\vec{K_h})^2]}$$
代入，即可得到能量本征值的二阶近似解：
$$E(\vec{k})=\frac{\hbar^2k^2}{2m}+\bar V+\sum_{h\neq 0}\frac{V(\vec{K_h})^2}{\frac{\hbar^2}{2m}[\vec{k}^2-(\vec{k}+\vec{K_h})^2]}$$


## 简并微扰

观察上述能量表达式，可知当$\vec{k}^2=(\vec{k}+\vec{K_h})^2$时，能量本征值是简并的。此时，其他散射波都可以忽略，最后剩下两个方程：
$$\begin{aligned}
\vec{K_h}=0&\Rightarrow[\frac{\hbar^2}{2m}\vec{k}^2-E(\vec{k})]a(\vec{k})+V(-\vec{K_h})a(\vec{k}+\vec{K_h})=0\\
\vec{K_h}&\Rightarrow[\frac{\hbar^2}{2m}(\vec{k}+\vec{K_h})^2-E(\vec{k})]a(\vec{k}+\vec{K_h})+V(\vec{K_h})a(\vec{k})=0\\
\end{aligned}$$
可以通过行列式解出：

$$\begin{aligned}
E_{\pm}(\vec{k})&=\frac12\{\frac{\hbar^2}{2m}[\vec{k}^2+(\vec{k}+\vec{K_h}^2)]\pm\sqrt{\frac{\hbar^4}{4m^2}[\vec{k}^2+(\vec{k}+\vec{K_h}^2)]^2+4|V(\vec{K_h})|^2}\}\\
&\approx \frac{\hbar^2}{2m}\vec{k}^2\pm|V(\vec{K_h})|\\
\end{aligned}$$

## 布里渊区与能隙
上述非简并微扰下，当$|\vec{k}|=|\vec{k}+\vec{K_h}|$时，计算发散。这个条件等同于$\vec{k}$落在倒格矢的垂直平分面上。倒格矢的垂直平分面依次围成布里渊区。

为什么会在布里渊区的边界上发生能隙现象呢？入射波遭布拉格衍射后，一般来说相互抵消，不影响入射波；但在布里渊区边界上，入射波和衍射波叠加形成驻波。以下是一个简单的图像。


### 一维晶体的非简并微扰
对于一维晶体，考虑非简并微扰的一阶修正：
$$E_k^1=|\langle k|\Delta V|k\rangle|=0$$
考虑二阶修正：
$$E_k^2=\sum_{k'}\frac{|\langle k'|\Delta V|k\rangle|^2}{E_k^0-E_{k'}^0}=\sum_{k'}\frac{|\langle k'| V(x)|k\rangle|^2}{E_k^0-E_{k'}^0}$$

其中矩阵元计算为：
$$\langle k'| V(x)|k\rangle=\delta_{k',k+\frac{2\pi n}{a}}V_n$$
由此能量二阶修正为：
$$E_k^2=\sum_{n\neq 0}\frac{|V_n|^2}{E_k^0-E_{k+\frac{2\pi n}{a}}^0}=\sum_n-\frac{|V_n|^2}{\frac{\hbar^2}{2m}[(k+\frac{2\pi n}{a})^2-k^2]}$$
对于波函数$\psi_k^0$，一阶修正为：
$$\begin{aligned}\psi_k(x)&=\psi_k^0(x)+\sum_{k'}\frac{\langle k'|\Delta V|k\rangle}{E_k^0-E_{k'}^0}\psi_{k'}^0(x)\\
&=\frac{1}{\sqrt{Na}}e^{ikx}-\sum_n\frac{V_n}{\frac{\hbar^2}{2m}[(k+\frac{2\pi n}{a})^2-k^2]}\frac{1}{\sqrt{Na}}e^{i(k+\frac{2\pi n}{a})x}\\
&=\frac{1}{\sqrt{Na}}e^{ikx}(1-\sum_n\frac{V_n}{\frac{\hbar^2}{2m}[(k+\frac{2\pi n}{a})^2-k^2]}\frac{1}{\sqrt{Na}}e^{i\frac{2\pi n}{a}x})\\
\end{aligned}$$

### 一维晶体的简并微扰
当$k=-\frac{\pi n}{a}$时，$k'=k+\frac{2\pi n}{a}=-k$，波函数$|\psi_k\rangle$是简并的，此时需要考虑简并微扰。


设线性叠加后的波函数为：
$$|\psi\rangle=a|\psi^0_k\rangle+b|\psi^0_{k'}\rangle$$
修正前的波函数满足：
$$H_0|\psi^0_k\rangle=E^0_k|\psi^0_k\rangle$$
$$H_0|\psi^0{k'}\rangle=E^0_{k'}|\psi^0_{k'}\rangle$$
修正后的波函数满足：
$$H|\psi\rangle=E|\psi\rangle$$
展开后有：
$$\begin{aligned}
(H_0+\Delta V)(a|\psi^0_k\rangle+b|\psi^0_{k'}\rangle)=E(a|\psi^0_k\rangle+b|\psi^0_{k'}\rangle)
\end{aligned}$$
左边同乘$\langle\psi^0_k|,\langle\psi^0_{k'}|$，有：
$$\begin{aligned}
E_k^0a+\langle\psi^0_k|\Delta V|\psi^0_{k'}\rangle b&=Ea\\
\langle\psi^0_{k'}|\Delta V|\psi^0_k\rangle a+E_{k'}^0b&=Eb
\end{aligned}$$
其中$\langle\psi^0_{k'}|\Delta V|\psi^0_k\rangle=\langle k'|\Delta V|k\rangle=V_n$，由解存在性，有：
$$\begin{aligned}
\begin{vmatrix}
E_k^0-E&V_n^*\\
V_n&E_{k'}^0-E
\end{vmatrix}=0
\end{aligned}$$
解得：
$$E_{\pm}=\frac{E_k^0+E_{k'}^0}{2}\pm\sqrt{(\frac{E_k^0-E_{k'}^0}{2})^2+|V_n|^2}=E_k^0\pm|V_n|$$
相应的本征波函数为：
$$\begin{aligned}
|\psi_+\rangle&=\frac{1}{\sqrt{2}}(|\psi^0_k\rangle+|\psi^0_{k'}\rangle)=\sqrt{\frac2L}\cos{\frac{n\pi}{a}} \\
|\psi_-\rangle&=\frac{1}{\sqrt{2}}(|\psi^0_k\rangle-|\psi^0_{k'}\rangle)=-i\sqrt{\frac2L}\sin{\frac{n\pi}{a}} 
\end{aligned}$$

对于非简并微扰，入射波和衍射波不耦合，但在简并微扰中，我们通过对角化提取出了驻波。这意味着能量更高的波函数喜欢出现在两个原子的中间，能量较低的波函数喜欢出现在原子上，这正是能隙的成因。

![布里渊区与能隙](\img\固体物理\4.png)


## 近似简并微扰
实际问题中，在布里渊区边界的附近，简并微扰也是近似有效的：
$$E_{\pm}=\frac{E_k^0+E_{k'}^0}{2}\pm\sqrt{(\frac{E_k^0-E_{k'}^0}{2})^2+|V_n|^2}$$
我们讨论其中的两种退化情形：
- 当$|E_k^0-E_{k'}^0|\gg|V_n|$时：
  $$E_{\pm}\approx\frac{E_k^0+E_{k'}^0}{2}\pm\frac{E_k^0-E_{k'}^0}{2}(1+\frac{|V_n|^2}{(E_k^0-E_{k'}^0)^2})\Rightarrow\begin{cases}
  E_+=E_k^0+\frac{|V_n|^2}{E_k^0-E_{k'}^0}\\E_-=E_{k'}^0-\frac{|V_n|^2}{E_k^0-E_{k'}^0}
  \end{cases}$$

  如果再做一次近似，得到：
  $$E_{\pm}\approx E_k^0=\frac{\hbar^2k^2}{2m}+\bar V$$
  这说明，当距离布里渊边界较远的时候，能量曲线为抛物线，可以忽略微扰。

- 当$|E_k^0-E_{k'}^0|\ll|V_n|$时：
  $$E_{\pm}\approx\frac{E_k^0+E_{k'}^0}{2}\pm|V_n|(1+\frac{(E_k^0-E_{k'}^0)^2}{8|V_n|^2})$$

  代入$k=-\frac{n\pi}{a}(1-\Delta),k'=\frac{n\pi}{a}(1+\Delta)$，有：
  $$\begin{cases}
  E_+= V+T_n+|V_n|+ \Delta^2T_n(\frac{2T_n}{|V_n|}+1)\\
  E_-=V+T_n-|V_n|- \Delta^2T_n(\frac{2T_n}{|V_n|}-1)
  \end{cases}$$
  其中$T_n=\frac{\hbar^2n^2\pi^2}{2ma^2}$，这意味着在距离布里渊边界较近的时候，$\Delta\rightarrow0$，能量曲线为带有能隙的抛物线。

![抛物线能带](\img\固体物理\6.png)

# 紧束缚近似
## 万尼尔函数
在平面波方法中，我们将布洛赫波函数按平面波（复数）展开。实际上，由于布洛赫波函数是倒空间的周期函数，所以也可以用正空间的周期函数展开：
$$\psi_k^n(\vec{r})=\frac1{\sqrt{N}}\sum_{l}a_n(\vec{R}_l,\vec{r})e^{i\vec{k}\cdot\vec{R}_l}$$
其中$a_n(\vec{R}_l,\vec{r})$称为万尼尔函数：
$$a_n(\vec{R}_l,\vec{r})=\frac1{\sqrt{N}}\sum_{\vec{k}}\psi_k^n(\vec{r})e^{-i\vec{k}\cdot\vec{R}_l}=\frac1{\sqrt{N}}\sum_{\vec{k}}u_k^n(\vec{r}-\vec{R}_l)e^{-i\vec{k}\cdot(\vec{r}-\vec{R})}$$
可见万尼尔函数只是宗量$\vec{r}-\vec{R}_l$的函数（这说明万尼尔函数是以$\vec{R}_l$为中心的局域函数），记：
$$a_n(\vec{R}_l,\vec{r})=a_n(\vec{r}-\vec{R}_l)$$

不难证明万尼尔函数是正交完备的：
- 正交性：
    $$\begin{aligned}
    \int a_n^*(\vec{r}-\vec{R}_l)a_{n'}(\vec{r}-\vec{R}_{l'})d\vec{r}&=\frac1N\sum_{\vec{k}}\sum_{\vec{k'}}\int \psi_k^n(\vec{r})^*\psi_{k'}^{n'}(\vec{r})e^{-i\vec{k}\cdot\vec{R}_l+\vec{k'}\cdot\vec{R}_{l'}}d\vec{r}\\
    &=\frac1N\sum_{\vec{k}}\sum_{\vec{k'}}\delta_{n,n'}\delta_{\vec{k},\vec{k'}}e^{-i\vec{k}\cdot\vec{R}_l+\vec{k'}\cdot\vec{R}_{l'}}\\
    &=\frac1N\sum_{\vec{k}}\delta_{n,n'}e^{-i\vec{k}\cdot(\vec{R}_l-\vec{R}_{l'})}\\
    &=\delta_{n,n'}\delta_{l,l'}
    \end{aligned}$$
- 完备性：
    $$\begin{aligned}
    \sum_{l,n}a_n^*(\vec{r}-\vec{R}_l)a_n(\vec{r}-\vec{R}_l)&=\frac1N\sum_{\vec{k}}\sum_{\vec{k'}}\sum_{l,n} \psi_k^n(\vec{r})^*\psi_{k'}^n(\vec{r})e^{-i\vec{k}\cdot\vec{R}_l+\vec{k'}\cdot\vec{R}_l}\\
    &=\delta(\vec{r}-\vec{r}')
    \end{aligned}$$

## 紧束缚近似假设
紧束缚近似的基本假设为：晶体中每个原子的势场对电子都有较强的束缚，使得电子的行为接近孤立原子中的电子。这时候，其他原子对该电子的吸引势被看作微扰。

在紧束缚近似假设下，可以选择孤立原子的定域波函数$\varphi_n(\vec{r}-\vec{R}_l)$作为万尼尔函数：
$$\left[-\frac{\hbar^2}{2m}\nabla^2+U(\vec{r}-\vec{R}_l)\right]\varphi_n(\vec{r}-\vec{R}_l)=E_n\varphi_n(\vec{r}-\vec{R}_l)$$
于是周期势场中的单电子波函数可以用上述函数展开：
$$\psi_k^n(\vec{r})=\frac1{\sqrt{N}}\sum_{l}\varphi_n(\vec{r}-\vec{R}_l)e^{i\vec{k}\cdot\vec{R}_l}$$
指标n表示不同轨道类型的波函数，如s和p轨道。该方法之所以是一种近似，是因为不同孤立原子的波函数之间是有重叠的，但在紧束缚假设中，重叠的部分很少，可以近似正交。

代入周期势场的单电子薛定谔方程：
$$\begin{aligned}
&\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})\right]\psi_k^n(\vec{r})=E_n(\vec{k})\psi_k^n(\vec{r})\\
\Rightarrow&\frac1{\sqrt{N}}\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E_n(\vec{k})\right]\sum_{l'}\varphi_n(\vec{r}-\vec{R}_{l'})e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow&\frac1{\sqrt{N}}\sum_{l'}\left[E_n-U(\vec{r}-\vec{R}_{l'})+V(\vec{r})-E_n(\vec{k})\right]\varphi_n(\vec{r}-\vec{R}_{l'})e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\end{aligned}$$
其中$V(\vec{r})=\sum_l U(\vec{r}-\vec{R}_l)$。左乘$\varphi_n^*(\vec{r}-\vec{R}_{l})$并对$\vec{r}$积分，利用正交性得到：
$$\begin{aligned}
&[E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}+\int d\vec{r}\sum_{l'}\left[V(\vec{r})-U(\vec{r}-\vec{R}_{l'})\right]\varphi_n^*(\vec{r}-\vec{R}_{l'})\varphi_n(\vec{r}-\vec{R}_l)e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow& [E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}+\int d\vec{r}\sum_{l'}\left[V(\vec{r}-\vec{R}_{l'})-U(\vec{r}-\vec{R}_{l'})\right]\varphi_n^*(\vec{r}-\vec{R}_{l'})\varphi_n(\vec{r}-\vec{R}_l)e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\xi=\vec{r}-\vec{R}_{l'}\Rightarrow& [E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}+\sum_{l'}\int d\vec{r}\left[V(\xi)-U(\xi)\right]\varphi_n^*[\xi-(\vec{R}_l-\vec{R}_{l'})]\varphi_n(\xi)e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow& [E_n-E_n(\vec{k})]e^{i\vec{k}\cdot\vec{R}_{l}}-\sum_{l'}J(\vec{R}_l-\vec{R}_{l'})e^{i\vec{k}\cdot\vec{R}_{l'}}=0\\
\Rightarrow& E_n(\vec{k})=E_n-\sum_{l'}J(\vec{R}_l-\vec{R}_{l'})e^{i\vec{k}\cdot(\vec{R}_{l'}-\vec{R}_{l})}=0\\
\end{aligned}$$
只取最邻近项：
$$\begin{aligned}
E_n(\vec{k})&=E_n-J(0)-\sum_{l\neq l'}^{\text{最近邻}}J(\vec{R}_l-\vec{R}_{l'})e^{-i\vec{k}\cdot(\vec{R}_{l}-\vec{R}_{l'})}\\&=E_n-J(0)-\sum_{s\neq 0}^{\text{最近邻}}J(\vec{R}_s)e^{-i\vec{k}\cdot\vec{R}_{s}}\end{aligned}$$

# 正交平面波方法

从上述的讨论中，我们发现，离子实区域外的电子受到周期势场的作用，更像一个波；而离子实区域内的电子受到孤立原子势场的作用，更像一个粒子。对于两种电子，分类讨论可以解决平面波方法的收敛问题。

若内层有M个电子态，他们仍可以使用相应的独立原子轨道为拟合：
$$|\psi_c\rangle=\varphi_c(\vec{r}-\vec{R}_l),c=1,2,...,M$$
对于外层的非定域电子（离子实内振荡，离子实外平滑），如果使用平面波，就无法避免高能平面波的引入。为了解决这一问题，考虑将此前的M个原子轨道作为基函数的一部分，线性组合得到：
$$|\psi_k\rangle=\sum_{c=1}^M \beta_c|\psi_c\rangle+\sum_{h} a(\vec{k}+\vec{K}_h)|\vec{k}+\vec{K}_h\rangle$$
这样可以有效减少平面波的引入。考虑外层波函数与内层波函数的正交性：
$$\langle \psi_k|\psi_c\rangle=0\Rightarrow 
\beta_c=-\sum_h a(\vec{k}+\vec{K}_h)\langle \psi_c|\vec{k}+\vec{K}_h\rangle$$
得到新的基组叫做正交平面波（Orthogonal Plane Wave，OPW）基组：
$$|OPW_{\vec{k}}\rangle=|\vec{k}\rangle-\sum_{c=1}^M |\psi_c\rangle\langle\psi_c|\vec{k}\rangle$$
这样，外层波函数就可以表示为：
$$|\psi_k\rangle=\sum_{h=1}^N a(\vec{k}+\vec{K}_h)|OPW_{\vec{k}+\vec{K}_h}\rangle$$

> 新的正交平面波基组自身反而不正交了，这导致在计算能量本征值时需要引入重叠矩阵的概念。
>
> 考虑基组$\{|\phi_i\rangle\}$，薛定谔方程指出存在本征能量和波函数：
> $$\hat H|\psi\rangle=E|\psi\rangle$$
> 其中$|\psi\rangle=\sum_i c_i|\phi_i\rangle$，代入后有：
> $$\sum_i c_i\hat H|\phi_i\rangle=E\sum_i c_i|\phi_i\rangle$$
> 左乘$\langle \phi_j|$，有：
> $$\sum_i c_i\langle \phi_j|\hat H|\phi_i\rangle=E\sum_i c_i\langle \phi_j|\phi_i\rangle$$
> - 对于正交基组，$\langle \phi_j|\phi_i\rangle=\delta_{ij}$，有：
> $$\sum_i c_i\langle \phi_j|\hat H|\phi_i\rangle=c_jE\Rightarrow H\vec{c}=E\vec{c}$$
> - 对于非正交基组，$\langle \phi_j|\phi_i\rangle=S_{ij}$，有：
> $$\sum_i c_i\langle \phi_j|\hat H|\phi_i\rangle=E\sum_i c_iS_{ij}\Rightarrow H\vec{c}=E S\vec{c}$$
> 这说明在非正交基组下，需要求解的是带有重叠矩阵的广义本征值问题。

# 赝势方法


将正交平面波展开代入薛定谔方程：
$$\begin{aligned}
&\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E(\vec{k})\right]\sum_{h} a(\vec{k}+\vec{K}_h)|OPW_{\vec{k}+\vec{K}_h}\rangle=0\\
\Rightarrow&\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E(\vec{k})\right]|\vec{k}+\vec{K}_h\rangle-\sum_{c=1}^M \left[-\frac{\hbar^2}{2m}\nabla^2+V(\vec{r})-E(\vec{k})\right]|\psi_c\rangle\langle\psi_c|\vec{k}+\vec{K}_h\rangle\right\}=0\\
\Rightarrow&\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_h)^2+V(\vec{r})-E(\vec{k})\right]|\vec{k}+\vec{K}_h\rangle-\sum_{c=1}^M \left[E_c-E(\vec{k})\right]|\psi_c\rangle\langle\psi_c|\vec{k}+\vec{K}_h\rangle\right\}=0\\
\Rightarrow&\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_h)^2-E(\vec{k})\right]|\vec{k}+\vec{K}_h\rangle+U|\vec{k}+\vec{K}_h\rangle\right\}=0\\
\end{aligned}$$
其中：
$$U=V-\sum_{c=1}^M \left[E_c-E(\vec{k})\right]|\psi_c\rangle\langle\psi_c|$$
变为矩阵方程：
$$\sum_{h} a(\vec{k}+\vec{K}_h)\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_h)^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|U|\vec{k}+\vec{K}_h\rangle\right\}=0$$
行列式为0：
$$\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|U|\vec{k}+\vec{K}_h\rangle\right\}=0$$


> 其具有和平面波方法矩阵方程同样的形式。以下是对比：
> - 平面波方法：
> $$\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|V|\vec{k}+\vec{K}_h\rangle\right\}=0$$
> - 正交平面波方法：
> $$\det\left\{\left[\frac{\hbar^2}{2m}(\vec{k}+\vec{K}_{h'})^2-E(\vec{k})\right]\delta_{\vec{K}_h,\vec{K}_{h'}}+\langle \vec{k}+\vec{K}_{h'}|U|\vec{k}+\vec{K}_h\rangle\right\}=0$$

将正交平面波方法导出的方程进行变形：
$$\left[-\frac{\hbar^2}{2m}\nabla^2-E(\vec{k})+U\right]\sum_{h} a(\vec{k}+\vec{K}_h)|\vec{k}+\vec{K}_h\rangle=0$$

相比于真实的薛定谔方程，我们将正交平面波基组替换为平面波基组，将真实势能$V(\vec{r})$替换为赝势$U(\vec{r})$。这代表我们通过改变势能为一个更加平滑的赝势来简化问题，得到了平滑解。对于只关心离子实外能带的情况，不失为一种简化。
