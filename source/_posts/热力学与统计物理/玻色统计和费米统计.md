---
title: 玻色统计和费米统计
mathjax: true
date: 2024-11-30 16:24:44
tags: 统计物理
categories: 统计物理
cover:
---

- [热力学统计量表达式](#热力学统计量表达式)
- [弱简并理想玻色气体和费米气体](#弱简并理想玻色气体和费米气体)
- [玻色-爱因斯坦凝聚](#玻色-爱因斯坦凝聚)
- [光子气体](#光子气体)
- [金属中的自由电子气体](#金属中的自由电子气体)

满足定域或非简并条件的粒子系统可以采用玻尔兹曼统计，而不满足非简并条件的系统，需要用玻色-爱因斯坦统计或费米-狄拉克统计处理。

> 不满足非简并条件的气体叫做简并气体。不同于理想气体，简并气体不满足定域条件。尽管气体之间的距离更大，但是气体粒子本身的波包尺度也更大。同样的道理，固体虽然原子之间间距小，但是波包更小，是定域系统。

粒子的简并情况也有所区别，具体可根据逸度$z=e^{-\alpha}$进行分类：

| 理想气体（非简并） | 理想玻色/费米气体（弱简并） | 光子气体 | 玻色-爱因斯坦凝聚 | 自由电子气（强简并） |
| --- | --- | --- | --- | --- |
| $e^{-\alpha}\ll1$ | $e^{-\alpha}\ll1$但不可忽略 | $e^{-\alpha}= 1$ | $e^{-\alpha}> 2.612$ | $e^{-\alpha}\gg 1$ |

其中，理想气体因为忽略相互作用，所以化学势$\mu$接近0，但我们在下面会讨论如果不忽略其影响会带来什么变化。自由电子气由于其费米能（化学势）远大于$kT$，所以在统计上表现出强简并特性。

# 热力学统计量表达式

考虑玻色系统，对于巨正则系综，定义巨配分函数：
$$\Xi = \prod_l \Xi_l=\prod_l (1-e^{-\alpha-\beta\epsilon_l})^{-\omega_l}$$
> 在系综理论中，我们会推导玻色统计和费米统计的巨配分函数。

系综的平均粒子数：
$$\langle N \rangle = -\frac{\partial }{\partial \alpha} \ln \Xi=\sum_l \omega_l\frac{\partial }{\partial \alpha}\ln [1-e^{-\alpha-\beta\epsilon_l}] = \sum_l \frac{\omega_l}{e^{\alpha+\beta\epsilon_l}-1}$$

系综和平均能量：
$$\langle E \rangle = -\frac{\partial }{\partial \beta} \ln \Xi=\sum_l \omega_l\frac{\partial }{\partial \beta}\ln [1-e^{-\alpha-\beta\epsilon_l}] = \sum_l \frac{\omega_l\epsilon_l}{e^{\alpha+\beta\epsilon_l}-1}$$

外界的广义作用力
$$\langle Y \rangle = -\frac1\beta\frac{\partial }{\partial y} \ln \Xi=\sum_l \omega_l\frac{\partial }{\partial y}\ln [1-e^{-\alpha-\beta\epsilon_l}] = \sum_l \frac{\omega_l}{e^{\alpha+\beta\epsilon_l}-1}\frac{\partial \epsilon_l}{\partial y}$$

熵：
$$S =k(\ln \Xi + \alpha \langle N \rangle + \beta \langle E \rangle)$$

巨热力学势：
$$J = -kT\ln \Xi$$

对于费米系统，巨配分函数：
$$\Xi = \prod_l \Xi_l=\prod_l (1+e^{-\alpha-\beta\epsilon_l})^{\omega_l}$$

将玻尔兹曼统计和玻色统计和费米统计对比:

|| 玻尔兹曼统计 | 玻色统计 | 费米统计 |
|---| --- | --- | --- |
|配分函数| $Z_1 = \sum_l \omega_le^{-\beta\epsilon_l}$ | $\Xi = \prod_l (1-e^{-\alpha-\beta\epsilon_l})^{-\omega_l}$ | $\Xi = \prod_l (1+e^{-\alpha-\beta\epsilon_l})^{\omega_l}$ |
|平均粒子数| $N = e^{-\alpha}Z_1$ | $\langle N \rangle =-\frac{\partial }{\partial \alpha} \ln \Xi$ | $\langle N \rangle =-\frac{\partial }{\partial \alpha} \ln \Xi$ |
|平均内能| $U =N(-\frac{\partial}{\partial\beta})\ln Z_1$ | $\langle U\rangle =-\frac{\partial }{\partial \beta} \ln \Xi$ | $\langle U \rangle = -\frac{\partial }{\partial \beta} \ln \Xi$ |
|外力| $Y -\frac{N}{\beta}\frac{\partial }{\partial y}\ln Z_1$ | $\langle Y \rangle =-\frac1\beta\frac{\partial }{\partial y} \ln \Xi$ | $\langle Y \rangle =-\frac1\beta\frac{\partial }{\partial y} \ln \Xi$ |
|熵| $S=Nk(\ln Z_1+\beta U)$ | $S =k(\ln \Xi + \alpha \langle N \rangle + \beta \langle E \rangle)$ | $S =k(\ln \Xi + \alpha \langle N \rangle + \beta \langle E \rangle)$ |

> 其实，玻色和费米统计的配分函数比玻尔兹曼“高一阶”（从求和变成连乘可以看出端倪）。对其求对数：
> $$\ln \Xi = \sum_l \ln (1\mp e^{-\alpha-\beta\epsilon_l})^{\mp\omega_l} = \sum_l \mp\omega_l\ln (1\mp e^{-\alpha-\beta\epsilon_l})$$
> 当满足非简并条件时，$e^{-\alpha}\ll 1$，所以可以用泰勒展开：
> $$\sum_l\mp\omega_l\ln (1\mp e^{-\alpha-\beta\epsilon_l}) \approx\sum_l\omega_l e^{-\alpha-\beta\epsilon_l}=e^{-\alpha}Z_1$$
> 可以看到，直接化为了玻尔兹曼统计的配分函数。

# 弱简并理想玻色气体和费米气体

在 {% post_link '热力学与统计物理/玻尔兹曼统计' %} 中，我们计算了理想气体的若干性质，现在我们考虑弱简并的理想玻色气体和费米气体。回顾此前的粒子数计算（用巨正则配分函数统一描述）：
$$N=-\frac{\partial }{\partial \alpha} \ln \Xi = -\frac{\partial e^{-\alpha}Z_1}{\partial \alpha}=e^{-\alpha}Z_1=\ln \Xi$$
这说明在非简并条件下，$\ln \Xi$对$\alpha$求导只改变符号。

在弱简并环境下就不能忽略：
$$\ln \Xi =\sum_l \mp\omega_l\ln (1\mp e^{-\alpha-\beta\epsilon_l})$$
的近似影响。代入 {% post_link '热力学与统计物理/近独立粒子的最概然分布' %} 中的自由粒子态密度公式，直接写出配分函数的计算公式：
$$\ln \Xi=\mp\int_0^\infty D(\epsilon)\ln (1\mp e^{-\alpha-\beta\epsilon})d\epsilon=\mp\frac{2\pi V}{h^3}(2m)^\frac32\int_0^\infty \epsilon^{1/2}\ln (1\mp e^{-\alpha-\beta\epsilon})d\epsilon$$

> Note：对于玻色气体，如果温度太低，可能会出现$e^{-\alpha}\geq 2.612$的情况，此时玻色-爱因斯坦凝聚会发生，这时候上述式子就会因为$D(\epsilon=0)=0$而不成立。这一点在下一节会讨论。

考虑弱简并条件，我们可以对$\ln (1- e^{-\alpha-\beta\epsilon})$进行泰勒展开：
$$\ln (1- e^{-\alpha-\beta\epsilon})\approx - \sum_{n=1}^\infty \frac{e^{-n(\alpha+\beta\epsilon)}}{n}$$
代入上式，得到：
$$\begin{aligned}\ln \Xi &= \frac{2\pi V}{h^3}(2m)^\frac32\int_0^\infty \epsilon^{1/2}\sum_{n=1}^\infty \frac{e^{-n(\alpha+\beta\epsilon)}}{n}d\epsilon\\
&=\frac{2\pi V}{h^3}(2m)^\frac32\sum_{n=1}^\infty \frac{e^{-n\alpha}}{n}\int_0^\infty \epsilon^{1/2} e^{-n\beta\epsilon}d\epsilon\\
(x=n\beta\epsilon)&=\frac{V}{h^3}(\frac{2\pi m}{\beta})^\frac32\sum_{n=1}^\infty \frac{e^{-n\alpha}}{n^{5/2}}\\
&=Z_1g_{\frac52}(z)\\
\end{aligned}$$
这里引入理想气体的配分函数$Z_1$，逸度$z$和玻色函数$g_\nu(z)$：
$$g_\nu(z)=\frac{1}{\Gamma(\nu)}\int_0^\infty \frac{t^{\nu-1}}{e^t/z-1}dt=\sum_{n=1}^\infty \frac{z^n}{n^\nu}$$
现在，我们可以放心求解各个热力学量了：
$$\begin{cases}
N&=-\dfrac{\partial z}{\partial \alpha} \dfrac{\partial \ln \Xi}{\partial z}  =Z_1 g_{\frac32}(z)\\
U&=-\dfrac{\partial \ln \Xi}{\partial \beta}  = \dfrac32 kT Z_1g_{\frac52}(z)\\
J&=-kT\ln \Xi = -kT Z_1 g_{\frac52}(z)\\
S&=k\left(\ln \Xi+\alpha N + \beta U\right)=k\left(\frac52Z_1 g_{\frac52}(z) + \alpha Z_1 g_{\frac32}(z)\right)
\end{cases}$$
进行简单的变换，就是：
$$U=\frac32 NkT\frac{g_{\frac52}(z)}{g_{\frac32}(z)}$$
$$pV=-J=\frac32 U$$
同样的道理，可以定义费米函数：
$$f_\nu(z)=\frac{1}{\Gamma(\nu)}\int_0^\infty \frac{t^{\nu-1}}{e^t/z+1}dt=\sum_{n=1}^\infty \frac{(-1)^{n+1}z^n}{n^\nu}$$
导出费米气体的热力学量，这里不再赘述。显然，费米函数在同阶情况下小于玻色函数。

> 对比理想气体和理想玻色气体的热力学量：
>
> | 量 | 理想气体 | 理想玻色气体 | 理想费米气体 |
> | --- | --- | --- | --- |
> | 配分函数 | $Z_1=\dfrac{V}{h^3}\left(\dfrac{2\pi m}{\beta}\right)^\frac32$ | $\ln\Xi=Z_1 g_{\frac52}(z)$ | $\ln\Xi=Z_1 f_{\frac52}(z)$ |
> | $N$ | $Z_1e^{-\alpha}=Z_1g_{\infty}(z)$ | $Z_1 g_{\frac32}(z)$ | $Z_1 f_{\frac32}(z)$ |
> | $U$ | $\dfrac32 NkT$ | $\dfrac32 NkT\dfrac{g_{\frac52}(z)}{g_{\frac32}(z)}$ | $\dfrac32 NkT\dfrac{f_{\frac52}(z)}{f_{\frac32}(z)}$ |
> | $S$ | $k\left(\dfrac52Z_1e^{-\alpha}+\alpha Z_1e^{-\alpha}\right)$ | $k\left(\dfrac52Z_1 g_{\frac52}(z) + \alpha Z_1 g_{\frac32}(z)\right)$ | $k\left(\dfrac52Z_1 f_{\frac52}(z) + \alpha Z_1 f_{\frac32}(z)\right)$ |
>
> 可以分析，理想玻色气体的内能较理想气体更小，而理想费米气体的内能较理想气体更大，这表明玻色子之间存在等效的吸引作用，而费米子之间存在等效的排斥作用。
>
> ![alt](/img/热力学/bose_fermi_function.png)

```
import numpy as np
import matplotlib.pyplot as plt

def g_nu(z, nu, n_terms=1000):
    """计算玻色函数 g_nu(z) = sum_{n=1}^∞ z^n / n^nu (级数展开)"""
    n = np.arange(1, n_terms + 1)
    return np.sum(z**n / (n**nu))

def f_nu(z, nu, n_terms=1000):
    """计算费米函数 f_nu(z) = sum_{n=1}^∞ (-1)^{n+1} z^n / n^nu (级数展开)"""
    n = np.arange(1, n_terms + 1)
    return np.sum((-1)**(n + 1) * z**n / (n**nu))

# 定义 z 的范围 (0 < z < 1)
z = np.linspace(0.01, 0.99, 1000)

# 计算 g_{5/2}(z) / g_{3/2}(z)
g_ratio = np.array([g_nu(zi, 5/2) / g_nu(zi, 3/2) for zi in z])

# 计算 f_{5/2}(z) / f_{3/2}(z)
f_ratio = np.array([f_nu(zi, 5/2) / f_nu(zi, 3/2) for zi in z])

# 绘制图形
plt.figure(figsize=(10, 6))
plt.plot(z, g_ratio, label=r'$\frac{g_{5/2}(z)}{g_{3/2}(z)}$', color='blue')
plt.plot(z, f_ratio, label=r'$\frac{f_{5/2}(z)}{f_{3/2}(z)}$', color='red')
plt.axhline(y=1, color='black', linestyle='--', label='1')

plt.xlabel('z (fugacity)')
plt.ylabel('Ratio')
plt.title(r'Comparison of $\frac{g_{5/2}(z)}{g_{3/2}(z)}$ and $\frac{f_{5/2}(z)}{f_{3/2}(z)}$ with 1')
plt.legend()
plt.grid(True)
plt.show()
```


# 玻色-爱因斯坦凝聚

由玻色分布的粒子数表达式：
$$a_l = \frac{\omega_l}{e^{\alpha+\beta\epsilon_l}-1}= \frac{\omega_l}{\exp{\dfrac{\epsilon_l-\mu}{kT}}-1}$$

显然$a_l>0$，所以$\mu<\epsilon_0$，$\epsilon_0$是最低能级的能量。当$T\to 0$时，$\mu\to \epsilon_0$，此时$\alpha\to -\infty$，$\beta\to \infty$，$a_l\to 0$，除了最低能级的粒子数，其他能级的粒子数都趋于0。这种现象称为玻色-爱因斯坦凝聚。

从
$$\begin{aligned}
N =\int_0^\infty g\frac{2\pi V}{h^3}(2m)^\frac32\epsilon^{1/2}\frac{1}{e^{\alpha+\beta\epsilon}\pm1}d\epsilon\\=\int_0^\infty g\frac{2\pi V}{h^3}(2mkT)^\frac32 \frac{x^{1/2}}{e^{\alpha+x}\pm1}dx\end{aligned}$$
可以导出
$$\begin{aligned}
n&=\int_0^\infty \frac{2\pi }{h^3}(2m)^\frac32\epsilon^{1/2}\frac{1}{\exp{\dfrac{\epsilon-\mu}{kT}}-1}d\epsilon\\(\mu\rightarrow0)&=\int_0^\infty \frac{2\pi }{h^3}(2mkT_c)^\frac32 \frac{x^{1/2}}{\exp{x}-1}dx\\
&= \frac{2\pi }{h^3}(2mkT_c)^\frac32 \frac{\sqrt{\pi}}{2}\times 2.612\\
\end{aligned}$$

也可以写为：
$$T_c = \frac{2\pi\hbar^2}{mk}\left(\frac{n}{2.612}\right)^{2/3}$$

但当$T<T_c$的时候，由于$n\propto T^{\frac32}$可知$n$也会变小，这违反了$n$是常数。这是因为在小于临界温度的时候粒子几乎全都跑到0能级：
$$n=n_0(T)+\int_0^\infty \frac{2\pi }{h^3}(2m)^\frac32\frac{\epsilon^{1/2}}{\exp{\frac{\epsilon}{kT}}-1}d\epsilon$$

所以：
$$n_0(T)=n\left[1-\left(\frac{T}{T_c}\right)^{3/2}\right]$$
这时候内能为大于0能级的粒子能量的平均值：
$$\begin{aligned}
u &= \int_0^\infty \frac{2\pi }{h^3}(2m)^\frac32\frac{\epsilon^{3/2}}{\exp{\frac{\epsilon}{kT}}-1}d\epsilon\\&=\int_0^\infty \frac{2\pi }{h^3}(2m)^\frac32(kT)^\frac52\frac{x^{3/2}}{\exp{x}-1}d\epsilon\\&=0.770NkT(\frac{T}{T_c})^{3/2}
\end{aligned}$$
热容：
$$C_v = \frac{du}{dT} = 1.925Nk\left(\frac{T}{T_c}\right)^{3/2}$$


# 光子气体
空窖能量守恒，但由于发射和吸收的光子的能量有高低，所以粒子数不守恒，那么拉格朗日法只需要引入一个乘子：
$$a_l=\frac{\omega_l}{e^{\beta\epsilon_l}-1}$$
$\alpha=-\frac{\mu}{kT}=0$意味着光子气体的化学势为0。

考虑到光子的自旋量子数为1，所以$\omega_l=2$，光子的态密度为：
$$D(p)dp =\int\frac{\omega Vp^2dp\sin\theta d\theta d\phi}{h^3}=\frac{V}{\hbar^3\pi^2}p^2dp$$
考虑到光子的能量关系：
$$\begin{cases}p=\hbar \frac{\omega}{c}\\\epsilon=\hbar\omega\end{cases}$$
得到：
$$D(\omega)d\omega =\frac{V}{\pi^2c^3}\omega^2d\omega$$
平均的光子数为：
$$dn(\omega,T) ={D(\omega)d\omega}\frac{a_l}{\omega_l}= \frac{V}{\pi^2c^3}\frac{\omega^2d\omega}{e^{\beta\hbar\omega}-1}$$

辐射场的内能为：
$$U(\omega,T)d\omega = \frac{V}{\pi^2c^3}\frac{\hbar\omega^3d\omega}{e^{\beta\hbar\omega}-1}$$

这就是普朗克公式。


> 对于低频情况$\beta \hbar \omega\ll1$：
> $$\begin{aligned}
n(\omega,T) &= \frac{V\omega^2}{\pi^2c^3\beta }d\omega
\end{aligned}$$
> 对于高频情况$\beta \hbar \omega\gg1$：
> $$\begin{aligned}
n(\omega,T) &= \hbar \omega\frac{V\omega^2}{\pi^2c^3 }e^{-\beta\hbar\omega}d\omega
\end{aligned}$$

总的内能为：
$$U(T) = \int_0^\infty U(\omega,T)d\omega = \frac{V}{\pi^2c^3}\int_0^\infty \frac{\hbar\omega^3d\omega}{e^{\beta\hbar\omega}-1}=\frac{\pi^2k^4}{15c^3\hbar^3}VT^4$$
内能密度的最大值有：
$$\frac{dU}{dT} = \frac{d}{dx}\frac{\omega^3d\omega}{e^{\beta\hbar\omega}-1}=0\Rightarrow \hbar\omega=2.822kT$$
这就是维恩位移定律。

光子气体的巨配分函数为：
$$\Xi = \prod_l (1-e^{-\beta\epsilon_l})^{-\omega_l} = \prod_l (1-e^{-\beta\hbar\omega})^{-2}$$
$$\ln \Xi = -2\int_0^\infty \ln(1-e^{-\beta\hbar\omega})d\omega=-\frac{V}{\pi^2c^3}\int_0^\infty \omega^2\ln(1-e^{-\beta\hbar\omega})d\omega=\frac{\pi^2V}{45c^3}\frac{1}{(\beta\hbar)^3}$$
所以内能：
$$U = -\frac{\partial J}{\partial \beta} = \frac{\pi^2}{15c^3}\frac{1}{\beta^4\hbar^3}$$

压强：
$$P = -\frac{\partial J}{\partial V} = \frac{1}{\beta}\frac{\partial \ln \Xi}{\partial V} = \frac{\pi^2}{45c^3}\frac{1}{\beta^4\hbar^3}$$

那么两者的关系：
$$P = \frac13 \frac UV$$

熵：
$$S = \frac{U+PV}{T} = \frac{4k\pi^2}{45c^3}\frac{V}{\beta^3\hbar^3}$$

# 金属中的自由电子气体
金属中的自由电子气体是强简并理想费米气体。根据费米-狄拉克分布：
$$a_l = \frac{2}{e^{\beta(\epsilon-\mu)}+1}$$
这里考虑了自旋的两个简并。

电子的量子态数为：
$$D(\epsilon)d\epsilon = 4\pi V(\frac{2m}{\hbar^2})^{3/2}\epsilon^{1/2}d\epsilon$$
平均电子数为：
$$dn = 4\pi V(\frac{2m}{\hbar^2})^{3/2}\frac{\epsilon^{1/2}}{e^{\beta(\epsilon-\mu)}+1}d\epsilon$$

化学势通过粒子总数求得：
$$N = \int_0^\infty 4\pi V(\frac{2m}{\hbar^2})^{3/2}\frac{\epsilon^{1/2}}{e^{\beta(\epsilon-\mu)}+1}d\epsilon$$

对于0K的电子气：

$$\begin{cases}a_l=2,\epsilon<\mu(0)\\a_l=0,\epsilon>\mu(0)\end{cases}$$
所以：
$$N = \int_0^{\mu(0)} 4\pi V(\frac{2m}{\hbar^2})^{3/2}\epsilon^{1/2}d\epsilon$$
解得：
$$\mu(0) = \frac{\hbar^2}{2m}\left(\frac{3\pi^2N}{V}\right)^{2/3}$$
这就是费米能级，令$\mu(0)=\frac{p_F^2}{2m}$，得到费米动量：
$$p_F = \hbar\left(\frac{3\pi^2N}{V}\right)^{1/3}$$
